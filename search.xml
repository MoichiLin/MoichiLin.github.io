<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hyprland-Wayland</title>
      <link href="/posts/2023/03/27/Hyprland+nvidia/"/>
      <url>/posts/2023/03/27/Hyprland+nvidia/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://pic.imgdb.cn/item/64217794a682492fccc3e662.png" alt="Hyprland" loading="lazy"></p><blockquote><p>详细编写了Hyprland的安装以及使用<br>包含有一系列的基础和必要软件的安装和使用方法，以及一些重要服务的配置</p></blockquote><span id="more"></span><hr><h1 id="Hyprland"><a href="#Hyprland" class="headerlink" title="Hyprland"></a>Hyprland</h1><p><a href="https://wiki.hyprland.org/">Hyprland Wiki</a></p><hr><blockquote><p>我的dotfiles文件(github)<br>    <a href="https://github.com/MoichiLin">我的dotfiles</a></p></blockquote><hr><h2 id="连网"><a href="#连网" class="headerlink" title="连网"></a>连网</h2><pre><code class="Bash">sudo systemctl enable --now NetworkManagernmcli dev wifi listnmcli dev wifi connect $WIFI-SSID password $WIFI-PASSWDnmcli dev wifi connect $WIFI-SSID password $WIFI-PASSWD hidden yes #连接隐藏wifi</code></pre><hr><h2 id="开启-32-位支持库"><a href="#开启-32-位支持库" class="headerlink" title="开启 32 位支持库"></a>开启 32 位支持库</h2><blockquote><p>编译pacman.conf<br>    去掉 <code>[multilib]</code> 一节中两行的注释，来开启 32 位库支持。</p></blockquote><pre><code class="Bash">sudo vim /etc/pacman.conf</code></pre><hr><h2 id="安装-paru"><a href="#安装-paru" class="headerlink" title="安装 paru"></a>安装 paru</h2><pre><code class="Bash">wget https://lvu.moichi.cn/res/paru-bin.pkg.tar.zstsudo pacman -U paru-bin.pkg.tar.zst</code></pre><hr><h2 id="安装Hyprland"><a href="#安装Hyprland" class="headerlink" title="安装Hyprland"></a>安装Hyprland</h2><blockquote><p>注意Hyprland和Hyprland-nvidia的区别<br>需要nvidia-patch的可以装后者</p></blockquote><pre><code class="Bash">paru -S hyprland-nvidia</code></pre><hr><h2 id="安装必要软件"><a href="#安装必要软件" class="headerlink" title="安装必要软件"></a>安装必要软件</h2><pre><code class="Bash">paru -S qt6-waylandparu -S qt5-waylandparu -S xorg-xwayland                                                   #xwaylandparu -S xdg-desktop-portal-wlrsudo pacman -S adobe-source-han-serif-cn-fonts wqy-zenhei              #安装几个开源中文字体 一般装上文泉驿就能解决大多wine应用中文方块的问题sudo pacman -S noto-fonts-cjk noto-fonts-emoji noto-fonts-extra        #安装谷歌开源字体及表情sudo pacman -S alsa-utils pipewire pipewire-alsa pipewire-jack wireplumber pipewire-pulse pavucontrol pamixer #pipewire声音及音量控制sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa pavucontrol pulseaudio-bluetooth pavucontrol     #pluse声音及音量控制sudo pacman -S brightnessctl                                           #屏幕背光控制sudo pacman -S ntfs-3g                                                 #识别NTFS格式的硬盘sudo pacman -S ark p7zip unrar unarchiver lzop lrzip                   #解压工具sudo pacman -S git wget kate bind                                      #一些工具以下的包不在下面的合集中paru -S wl-gammactl                                                     #gamma,亮度,对比度sudo pacman -S bluez bluez-utils bluez-libs bluez-qt bluez-tools blueman bluedevil  #蓝牙</code></pre><details><summary>复制所有</summary><pre><code class="Bash">paru -S qt6-wayland qt5-wayland xorg-xwayland adobe-source-han-serif-cn-fonts wqy-zenhei ntfs-3g noto-fonts-cjk noto-fonts-emoji noto-fonts-extra alsa-utils pipewire pipewire-alsa pipewire-jack wireplumber pipewire-pulse pavucontrol brightnessctl git wget kate bind ark p7zip unrar unarchiver lzop lrzip</code></pre></details><hr><h2 id="一些刚需软件"><a href="#一些刚需软件" class="headerlink" title="一些刚需软件"></a>一些刚需软件</h2><pre><code class="Bash">sudo pacman -S fcitx5-im               #基础包组sudo pacman -S fcitx5-chinese-addons   #官方中文输入引擎sudo pacman -S fcitx5-material-color   #主题paru -S kitty python-pillow            #kitty 在wayland下支持ranger预览文件paru -S waybar-hyprland                #barparu -S grim slurp                     #截图paru -S wl-clipboard                   #剪贴板paru -S mako                           #通知paru -S wpaperd                        #壁纸。 可自动切换同路径下随机壁纸paru -S swaylock                       #锁屏paru -S wlogout                        #wlogout 可用来帐户登出，关机重启等操作paru -S kanshi                         #屏幕paru -S thunar gvfs gvfs-mtp thunar-archive-plugin file-roller   #文件管理器paru -S ranger ttf-nerd-fonts-symbols-1000-em-mono highlight atool   #终端文件管理器paru -S greetd greetd-tuigreet         #登录管理器以下的包不在下面的合集中paru -S mpvpaper                       #视频壁纸</code></pre><details><summary>复制所有</summary><pre><code class="Bash">paru -S fcitx5-im fcitx5-chinese-addons fcitx5-material-color kitty python-pillow waybar-hyprland grim slurp wl-clipboard mako swaylock wlogout kanshi thunar gvfs gvfs-mtp thunar-archive-plugin file-roller ranger ttf-nerd-fonts-symbols-1000-em-mono highlight atool wpaperd greetd greetd-tuigreet</code></pre></details><hr><h2 id="其他软件"><a href="#其他软件" class="headerlink" title="其他软件"></a>其他软件</h2><pre><code class="Bash">paru -S clash-meta-bin                          #clashparu -S aria2                                      #aria2服务paru -S chromium gtk4 firefox                      #chromium firefoxparu -S icalingua++ telegram-desktop-bin           #QQ telegramparu -S youtube-music-bin                          #youtube-music带各种实用插件paru -S mpv nomacs kate                            #视频播放 图片查看 文本编辑paru -S obs-studio wlrobs-hg                       #OBSparu -S refind                                     #引导工具paru -S scrcpy                                     #投屏软件paru -S android-tools                              #adb工具paru -S gamemode steam                             #Steamparu -S dxvk-bin vkd3d vkd3d-proton-bin            #dx9,10,11,12 to vulkanparu -S vbam-wx fceux melonds-bin citra-qt-bin ffmpeg4.4 ryujinx-bin #GBA FC NDS 3DS SWITCH 模拟器paru -S virtualbox virtualbox-host-dkms virtualbox-guest-iso  #virtualboxparu -S virtualbox-ext-oracle以下的包不在下面的合集中paru -S mesen2-git desmume-git yuzu-mainline-bin   #另可选FC和NDS模拟器 不推荐paru -S retroarch retroarch-assets-ozone retroarch-assets-xmb libretro-nestopia-git libretro-vba-next-git libretro-desmume-git  #retroarch 包含很多常见游戏平台的模拟器paru -S genymotion                                 #安卓环境基于vbox,建议添加arm_translation以支持arm转换paru -S v2raya-bin v2ray                           #v2raya</code></pre><details><summary>复制所有</summary><pre><code class="Bash">paru -S clash-premium-bin aria2 chromium gtk4 firefox icalingua++ telegram-desktop-bin youtube-music-bin mpv nomacs kate obs-studio wlrobs-hg refind scrcpy android-tools gamemode steam dxvk-bin vkd3d vkd3d-proton-bin vbam-wx fceux melonds-bin citra-qt-bin ffmpeg4.4 yuzu-mainline-bin virtualbox virtualbox-host-dkms virtualbox-guest-iso virtualbox-ext-oracle</code></pre></details><blockquote><p>arm转译包<br>    <a href="https://github.com/m9rco/Genymotion_ARM_Translation">arm_translation</a></p></blockquote><hr><h2 id="显卡驱动"><a href="#显卡驱动" class="headerlink" title="显卡驱动"></a>显卡驱动</h2><h3 id="英特尔核芯显卡"><a href="#英特尔核芯显卡" class="headerlink" title="英特尔核芯显卡"></a>英特尔核芯显卡</h3><pre><code class="Bash">sudo pacman -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel</code></pre><h3 id="Nvidia显卡驱动"><a href="#Nvidia显卡驱动" class="headerlink" title="Nvidia显卡驱动"></a>Nvidia显卡驱动</h3><pre><code class="Bash">sudo pacman -S nvidia-settings nvidia-utils lib32-nvidia-utils nvidia-dkms nvidia-prime opencl-nvidia lib32-opencl-nvidia vulkan-headers vulkan-icd-loader lib32-vulkan-icd-loader cuda</code></pre><h3 id="视频加速"><a href="#视频加速" class="headerlink" title="视频加速"></a>视频加速</h3><pre><code class="Bash">paru -S libva libva-intel-driver libva-mesa-driver libva-nvidia-driver libva-utils</code></pre><details><summary>复制所有</summary><pre><code class="Bash">paru -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel nvidia-settings nvidia-utils lib32-nvidia-utils nvidia-dkms nvidia-prime opencl-nvidia lib32-opencl-nvidia vulkan-headers vulkan-icd-loader lib32-vulkan-icd-loader cuda libva libva-intel-driver libva-mesa-driver libva-nvidia-driver libva-utils</code></pre></details><pre><code class="Bash">paru -S libva-vdpau-driver-wayland  #与libva-nvidia-driver冲突</code></pre><h3 id="设置早期KMS启动并启用DRM"><a href="#设置早期KMS启动并启用DRM" class="headerlink" title="设置早期KMS启动并启用DRM"></a>设置早期KMS启动并启用DRM</h3><h4 id="添加内核参数"><a href="#添加内核参数" class="headerlink" title="添加内核参数"></a>添加内核参数</h4><blockquote><p>修改 <code>/etc/default/grub</code> 找到 GRUB_CMDLINE_LINUX_DEFAULT这一项在后面加入 nvidia-drm.modeset=1</p></blockquote><pre><code class="Bash">GRUB_CMDLINE_LINUX_DEFAULT="nvidia-drm.modeset=1”</code></pre><blockquote><p>更改完成后执行，下面命令，会重新生成grub.cfg。</p></blockquote><pre><code class="Bash">sudo grub-mkconfig -o /boot/grub/grub.cfg</code></pre><h4 id="添加-initramfs-模块"><a href="#添加-initramfs-模块" class="headerlink" title="添加 initramfs 模块"></a>添加 initramfs 模块</h4><blockquote><p>在 <code>/etc/mkinitcpio.conf</code> 中找到 MODULES=这一行在括号的后面加入intel_agp i915 nvidia nvidia_modeset nvidia_uvm  nvidia_drm。</p></blockquote><pre><code class="Bash">MODULES=(intel_agp i915 nvidia nvidia_modeset nvidia_uvm nvidia_drm)</code></pre><blockquote><p>别忘了重新生成一下 initramfs 执行</p></blockquote><pre><code class="Bash">sudo mkinitcpio -P</code></pre><h3 id="创建nvidia-hook"><a href="#创建nvidia-hook" class="headerlink" title="创建nvidia hook"></a>创建nvidia hook</h3><blockquote><p>创建<code>/etc/pacman.d/hooks/nvidia.hook</code> 内容为</p></blockquote><pre><code class="Bash">[Trigger]Operation=InstallOperation=UpgradeOperation=RemoveType=PackageTarget=nvidia-dkmsTarget=linux-zen# Change the linux part above and in the Exec line if a different kernel is used[Action]Description=Update Nvidia module in initcpioDepends=mkinitcpioWhen=PostTransactionNeedsTargetsExec=/bin/sh -c 'while read -r trg; do case $trg in linux) exit 0; esac; done; /usr/bin/mkinitcpio -P'</code></pre><h3 id="添加全局变量调用nvidia-如果你要用awesome-就不要加入"><a href="#添加全局变量调用nvidia-如果你要用awesome-就不要加入" class="headerlink" title="添加全局变量调用nvidia (如果你要用awesome, 就不要加入)"></a>添加全局变量调用nvidia (如果你要用awesome, 就不要加入)</h3><blockquote><p>sudo vim /etc/environment</p></blockquote><pre><code class="Bash">__NV_PRIME_RENDER_OFFLOAD=1__GLX_VENDOR_LIBRARY_NAME="nvidia"__VK_LAYER_NV_optimus="NVIDIA_only"</code></pre><h2 id="各软件的配置"><a href="#各软件的配置" class="headerlink" title="各软件的配置"></a>各软件的配置</h2><h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><blockquote><p>编辑environment<br>    在 <code>/etc/environment</code> 加入以下内容</p></blockquote><pre><code class="Bash">GTK_IM_MODULE=fcitxQT_IM_MODULE=fcitxXMODIFIERS=@im=fcitxSDL_IM_MODULE=fcitxINPUT_METHOD=fcitxGLFW_IM_MODULE=ibus</code></pre><h3 id="greetd配置"><a href="#greetd配置" class="headerlink" title="greetd配置"></a>greetd配置</h3><blockquote><p>编缉 <code>/etc/greetd/config.toml</code></p></blockquote><pre><code class="Bash">[default_session]command = "tuigreet --cmd wayfire"user = "$USER"</code></pre><h3 id="kitty配置"><a href="#kitty配置" class="headerlink" title="kitty配置"></a>kitty配置</h3><pre><code class="Bash">cd ~/.config/kittyln -s ./kitty-themes/themes/Material.conf ~/.config/kitty/theme.conf</code></pre><blockquote><p>在 <code>kitty.conf</code> 里添加内容</p></blockquote><pre><code class="Bash">include ./theme.conf</code></pre><h3 id="ranger配置"><a href="#ranger配置" class="headerlink" title="ranger配置"></a>ranger配置</h3><pre><code class="Bash">git clone https://github.com/alexanderjeurissen/ranger_devicons ~/.config/ranger/plugins/ranger_deviconsecho "default_linemode devicons" &gt;&gt; $HOME/.config/ranger/rc.conf</code></pre><h3 id="wpaperd配置"><a href="#wpaperd配置" class="headerlink" title="wpaperd配置"></a>wpaperd配置</h3><blockquote><p>定时自动切换壁纸<br>    wpaperd可以针对不同屏幕设置不同的壁纸以及不同定时的自动切换壁纸<br>    以下为2块屏幕的相同定时时读取同一路径下随机壁纸的例子</p></blockquote><pre><code class="Bash">[eDP-1]path = "～/wallpaper/"apply-shadow = trueduration = "6m"[HDMI-A-1]path = "～/wallpaper/"apply-shadow = trueduration = "6m"</code></pre><h3 id="zsh主题-powerlevel10k"><a href="#zsh主题-powerlevel10k" class="headerlink" title="zsh主题-powerlevel10k"></a>zsh主题-powerlevel10k</h3><pre><code class="Bash">echo 'source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme' &gt;&gt; ~/.zshrc</code></pre><h3 id="vbox配置"><a href="#vbox配置" class="headerlink" title="vbox配置"></a>vbox配置</h3><pre><code class="Bash">sudo usermod -a -G vboxusers $USER</code></pre><h3 id="refind配置"><a href="#refind配置" class="headerlink" title="refind配置"></a>refind配置</h3><pre><code class="Bash">refind-install                      #安装refindsudo cp -r $theme /efi/EFI/refind/  #复制主题 推荐rEFInd-minimalsudo suecho 'include themes/rEFInd-minimal/theme.conf' &gt;&gt; /efi/EFI/refind/refind.conf  #应用主题</code></pre><h3 id="aria2配置"><a href="#aria2配置" class="headerlink" title="aria2配置"></a>aria2配置</h3><blockquote><p>编辑 aria2.service<br>sudo vim /etc/systemd/user/aria2.service</p></blockquote><pre><code class="Bash">[Unit]Description=Aria2 Daemon[Service]ExecStart=/usr/bin/aria2c --conf-path=~/.config/aria2/aria2.config[Install]WantedBy=default.target</code></pre><blockquote><p>生成服务所需文件</p></blockquote><pre><code class="Bash">touch ~/.config/aria2/aria2.sessionvim ~/.config/aria2/aria2.config</code></pre><blockquote><p>启动服务</p></blockquote><pre><code class="Bash">systemctl --user enable --now aria2  #非root服务自启</code></pre><blockquote><p>config可以在网上找一份，也可以改一改我的</p></blockquote><h3 id="V2raya"><a href="#V2raya" class="headerlink" title="V2raya"></a>V2raya</h3><pre><code class="Bash">yay -S v2raya-bin v2raysudo systemctl enable --now v2raya  #服务自启Dashboard: 127.0.0.1:2017</code></pre><h3 id="Clash"><a href="#Clash" class="headerlink" title="Clash"></a>Clash</h3><pre><code class="Bash">yay -S clash-permium-bin</code></pre><blockquote><p>start with <code>clash</code><br>如果country.mmdb下载失败, 手动复制<br>再配置自己的配置文件</p></blockquote><pre><code class="Bash">cp $Country.mmdb /home/$username/.config/clash/cp $ur_config.yaml /home/$username/.config/clash/</code></pre><blockquote><p>clash依赖<br>    <a href="https://github.com/SukkaW/Koolshare-Clash/blob/master/koolclash/koolclash/config/Country.mmdb">Country.mmdb</a></p></blockquote><h4 id="Clash-TUN-及分流配置"><a href="#Clash-TUN-及分流配置" class="headerlink" title="Clash TUN 及分流配置"></a>Clash TUN 及分流配置</h4><blockquote><p>开启流量转发</p></blockquote><pre><code class="Bash">sysctl -w net.ipv4.ip_forward=1</code></pre><blockquote><p>53端口可能被占用，先关掉默认系统DNS端口</p></blockquote><pre><code class="Bash">systemctl disable systemd-resolved</code></pre><blockquote><p>配置config.yaml<br>    <a href="https://github.com/MoichiLin/dotfiles/blob/main/clash/config.yaml">dotfile</a></p></blockquote><blockquote><p>编辑 clash.service<br>sudo vim /etc/systemd/system/clash.service</p></blockquote><pre><code class="Bash">[Unit]Description=Clash daemon, A rule-based proxy in Go.After=network.target[Service]Type=simpleRestart=alwaysExecStart=/usr/bin/clash -d ~/.config/clash[Install]WantedBy=default.target</code></pre><blockquote><p>启动服务</p></blockquote><pre><code class="Bash">systemctl enable --now clash #服务自启</code></pre><blockquote><p>Dashboard: <a href="https://clash.razord.top/">https://clash.razord.top/</a></p></blockquote><h3 id="yuzu配置"><a href="#yuzu配置" class="headerlink" title="yuzu配置"></a>yuzu配置</h3><blockquote><p>放置yuzu key<br>    运行yuzu需要key<br>    把以下文件解压覆盖到</p></blockquote><pre><code class="Bash">~/.local/share/yuzu/`</code></pre><blockquote><p>key文件<br>    <a href="https://www.dropbox.com/s/zzmrx35emikqfn0/YUZU_KEY.rar?dl=0">YUZU_KEY</a></p></blockquote><h3 id="Chromium-开启Google-Chrome同步"><a href="#Chromium-开启Google-Chrome同步" class="headerlink" title="Chromium 开启Google Chrome同步"></a>Chromium 开启Google Chrome同步</h3><blockquote><p>其他文章<br>    <a href="https://www.moichi.cn/posts/2023/02/06/Chromium-Google-Sync/">本站跳转</a></p></blockquote><h3 id="Chrome-wayland-不建议"><a href="#Chrome-wayland-不建议" class="headerlink" title="Chrome wayland (不建议)"></a>Chrome wayland (不建议)</h3><blockquote><p>让Chrome在wayland下运行<br>    把 <code>--gtk-version=4</code> 添加到每一个Exec的未尾<br>    在chrome上打开chrome://flags<br>    Preferred Ozone platform 换成 wayland<br>    以支持fcitx5在chrome在wayland下运行</p></blockquote><pre><code class="Bash">sudo vim /usr/share/applications/google-chrome.desktop</code></pre><hr><h2 id="Waydroid-不推荐"><a href="#Waydroid-不推荐" class="headerlink" title="Waydroid (不推荐)"></a>Waydroid (不推荐)</h2><pre><code class="Bash">yay -S waydroid waydroid-imagesudo waydroid initsudo waydroid init -s GAPPS -fsystemctl start waydroid-container.servicewaydroid session startwaydroid show-full-uisudo mount --bind &lt;source&gt; ~/.local/share/waydroid/data/media/0/&lt;target&gt; #共享文件夹</code></pre>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
            <tag> wayland </tag>
            
            <tag> hyprland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Install Arch on ZFS</title>
      <link href="/posts/2023/03/08/ZFS-Arch/"/>
      <url>/posts/2023/03/08/ZFS-Arch/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://pic.imgdb.cn/item/6408bd82f144a010073e9bd0.png" alt="OpenZFS" loading="lazy"></p><blockquote><p>本文为在zfs上安装arch的根分区的教程<br>以及双盘双池，根和home分开，根分区的盘经常性格式化的情况下的处理思路</p></blockquote><span id="more"></span><h1 id="安装前的准备"><a href="#安装前的准备" class="headerlink" title="安装前的准备"></a>安装前的准备</h1><blockquote><p>我们有两种方式来使liveCD里加入archzfs</p></blockquote><h2 id="一-使用archiso-zfs项目"><a href="#一-使用archiso-zfs项目" class="headerlink" title="一. 使用archiso-zfs项目"></a>一. 使用archiso-zfs项目</h2><blockquote><p>先制作一个原iso制作的liveCD，并进入liveCD</p></blockquote><blockquote><p>reflector 会为你选择速度合适的镜像源，但其结果并不准确，同时会清空配置文件中的内容，对于新人来讲并不适用，我们首先对其进行禁用。</p></blockquote><pre><code class="Bash">systemctl stop reflector.service</code></pre><blockquote><p>联网，用iwd连wifi，或者用有线</p></blockquote><pre><code class="Bash">timedatectl set-ntp true</code></pre><blockquote><p>编辑镜像源，选择ustc等源提前</p></blockquote><pre><code class="Bash">vim /etc/pacman.d/mirrorlist</code></pre><blockquote><p>更新一下所有的包</p></blockquote><pre><code class="Bash">pacman -Syu</code></pre><blockquote><p>加载zfs模块(由于代理等问题，如果无法通过此脚本安装，请用方法二)</p></blockquote><pre><code class="Bash">curl -s https://ghproxy.com/https://raw.githubusercontent.com/eoli3n/archiso-zfs/master/init | bash -x</code></pre><pre><code class="Bash">modprobe zfs</code></pre><h2 id="二-自己制作archiso"><a href="#二-自己制作archiso" class="headerlink" title="二. 自己制作archiso"></a>二. 自己制作archiso</h2><blockquote><p>首先在已经开机的arch上，在/etc/pacman.conf里加入archzfs源</p></blockquote><pre><code class="Bash">[archzfs]Server = http://archzfs.com/$repo/$arch</code></pre><blockquote><p>安装archiso工具，并设置路径</p></blockquote><pre><code class="Bash">sudo pacman -Sy archisomkdir ~/isocp -r /usr/share/archiso/configs/releng/* ~/iso</code></pre><blockquote><p>在archiso路径下的pacman.conf输入zfs相关配置</p></blockquote><pre><code class="Bash">echo -e '[archzfs]Server = http://archzfs.com/$repo/$archSigLevel = Optional TrustAll' &gt;&gt; ~/iso/pacman.confecho -e 'linux-headersarchzfs-dkmszfs-utils' &gt;&gt; ~/iso/packages.x86_64</code></pre><blockquote><p>构建iso</p></blockquote><pre><code class="Bash">sudo mkarchiso -vo ~/iso/out ~/iso</code></pre><blockquote><p>通过etcher等工具把iso烧录到u盘</p></blockquote><h3 id="手动加入zfs-key"><a href="#手动加入zfs-key" class="headerlink" title="手动加入zfs key"></a>手动加入zfs key</h3><blockquote><p>如果在开始安装过程中无法通过eoli3n的zfs脚本直接安装和挂载zfs模块<br>或者archzfs key导入失败等<br>请用以下方式</p></blockquote><blockquote><p>首先在已经开机的arch上，在/etc/pacman.conf里加入archzfs源</p></blockquote><pre><code class="Bash">[archzfs]Server = http://archzfs.com/$repo/$arch</code></pre><blockquote><p>然后手动装archzfs key加入信任</p></blockquote><pre><code class="Bash">pacman-key -r DDF7DB817396A49B2A2723F7403BD972F75D9D76pacman-key --lsign-key DDF7DB817396A49B2A2723F7403BD972F75D9D76</code></pre><h1 id="硬盘分区"><a href="#硬盘分区" class="headerlink" title="硬盘分区"></a>硬盘分区</h1><blockquote><p>网上过多一块硬盘装arch在zfs的教程，本教程讲两块盘，两个池<br>我的目的是一块盘做一个池装根分区，另一个盘做另一个池做home目录<br>我的盘是一块nvme，一块sata，所以以下内容可以看出是哪块盘</p></blockquote><pre><code class="Bash">parted /dev/nvme0n1parted /dev/sdacfdisk /dev/nvme0n1cdfisk /dev/sda</code></pre><blockquote><p>nvme0n1p1 分区 type 选 efi<br>nvme0n1p2 分区 type 选 Solaris root</p></blockquote><blockquote><p>sda1 分区 type 选 Solaris home</p></blockquote><h1 id="创建zfs-pools"><a href="#创建zfs-pools" class="headerlink" title="创建zfs pools"></a>创建zfs pools</h1><blockquote><p>把 nvme0n1p2 入加到名为 zroot 的池中</p></blockquote><pre><code class="Bash">zpool create -f -o ashift=12           \             -O acltype=posixacl       \             -O relatime=on            \             -O xattr=sa               \             -O dnodesize=legacy       \             -O normalization=formD    \             -O mountpoint=none        \             -O canmount=off           \             -O devices=off            \             -O compression=lz4        \             -R /mnt                   \             zroot /dev/nvme0n1p2</code></pre><blockquote><p>把 sda1 入加到名为 zhome 的池中</p></blockquote><pre><code class="Bash">zpool create -f -o ashift=12           \             -O acltype=posixacl       \             -O relatime=on            \             -O xattr=sa               \             -O dnodesize=legacy       \             -O normalization=formD    \             -O mountpoint=none        \             -O canmount=off           \             -O devices=off            \             -O compression=lz4        \             -R /mnt                   \             zhome /dev/sda1</code></pre><h1 id="创建dataset"><a href="#创建dataset" class="headerlink" title="创建dataset"></a>创建dataset</h1><blockquote><p>在zroot下创建arch为arch的根目录<br>在zhome下创建home为home目录</p></blockquote><pre><code class="Bash">zfs create -o mountpoint=/ -o canmount=noauto zroot/archzfs create -o mountpoint=/home zhome/home</code></pre><blockquote><p>mountpoint是挂载点，不要搞错，zroot都是-R /mnt下，但是zhome和zhome/home，要么前者-R /mnt，要么后者mountpoint=/home</p></blockquote><blockquote><p>然后挂载dataset和efi</p></blockquote><pre><code class="Bash">zfs mount zroot/archzfs mount zhome/homemkdir /mnt/efimount /dev/nvme0n1p1 /mnt/efi</code></pre><blockquote><p>然后检查一下我们的挂载是否正确，结果应该是<br>zroot/arch———/mnt<br>zhome/home—–/mnt/home<br>nvme0n1p1——/mnt/efi</p></blockquote><pre><code class="Bash">df -h</code></pre><h1 id="对dataset做最后处理"><a href="#对dataset做最后处理" class="headerlink" title="对dataset做最后处理"></a>对dataset做最后处理</h1><h2 id="设置bootfs"><a href="#设置bootfs" class="headerlink" title="设置bootfs"></a>设置bootfs</h2><pre><code class="Bash">zpool set bootfs=zroot/arch zroot</code></pre><h2 id="设置zpool-cache"><a href="#设置zpool-cache" class="headerlink" title="设置zpool.cache"></a>设置zpool.cache</h2><pre><code class="Bash">zpool set cachefile=/etc/zfs/zpool.cache zrootzpool set cachefile=/etc/zfs/zpool.cache zhomemkdir /mnt/etcmkdir /mnt/etc/zfscp /etc/zfs/zpool.cache /mnt/etc/zfs/zpool.cache</code></pre><h1 id="对-x2F-mnt做一些基本处理"><a href="#对-x2F-mnt做一些基本处理" class="headerlink" title="对/mnt做一些基本处理"></a>对/mnt做一些基本处理</h1><h2 id="往-x2F-mnt里安装一些基本包"><a href="#往-x2F-mnt里安装一些基本包" class="headerlink" title="往/mnt里安装一些基本包"></a>往/mnt里安装一些基本包</h2><pre><code class="Bash">pacstrap /mnt base base-devel linux-zen linux-zen-headers linux-firmware dhcpcd iwd vim bash-completion fish networkmanager zfs-dkms</code></pre><h2 id="生成fstab文件"><a href="#生成fstab文件" class="headerlink" title="生成fstab文件"></a>生成fstab文件</h2><pre><code class="Bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></pre><h2 id="注释掉fstab中zfs的内容"><a href="#注释掉fstab中zfs的内容" class="headerlink" title="注释掉fstab中zfs的内容"></a>注释掉fstab中zfs的内容</h2><pre><code class="Bash">vim /mnt/etc/fstab</code></pre><h1 id="arch-chroot"><a href="#arch-chroot" class="headerlink" title="arch-chroot"></a>arch-chroot</h1><pre><code class="Bash">arch-chroot /mnt</code></pre><h2 id="设置zpool-cache-1"><a href="#设置zpool-cache-1" class="headerlink" title="设置zpool.cache"></a>设置zpool.cache</h2><pre><code class="Bash">zpool set cachefile=/etc/zfs/zpool.cache zrootzpool set cachefile=/etc/zfs/zpool.cache zhome</code></pre><h2 id="开启32位源-multilib-，加入archzfs源"><a href="#开启32位源-multilib-，加入archzfs源" class="headerlink" title="开启32位源[multilib]，加入archzfs源"></a>开启32位源[multilib]，加入archzfs源</h2><pre><code class="Bash">vim /etc/pacman.conf</code></pre><blockquote><p>archzfs源</p></blockquote><pre><code class="Bash">[archzfs]Server = http://archzfs.com/$repo/$arch</code></pre><blockquote><p>编辑镜像源，选择ustc等源提前</p></blockquote><pre><code class="Bash">vim /etc/pacman.d/mirrorlist</code></pre><h2 id="时区设置"><a href="#时区设置" class="headerlink" title="时区设置"></a>时区设置</h2><blockquote><p>设置时区，在 /etc/localtime 下用/usr 中合适的时区创建符号连接。如下设置上海时区。</p></blockquote><pre><code class="Bash">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></pre><blockquote><p>随后进行硬件时间设置，将当前的正确 UTC 时间写入硬件时间。</p></blockquote><pre><code class="Bash">hwclock --systohc</code></pre><h2 id="设置-Locale-进行本地化"><a href="#设置-Locale-进行本地化" class="headerlink" title="设置 Locale 进行本地化"></a>设置 Locale 进行本地化</h2><pre><code class="Bash">vim /etc/locale.gen             #en_US.UTF-8 所在行以及 zh_CN.UTF-8 所在行的注释符号（#）locale-gen</code></pre><blockquote><p>向 <code>/etc/locale.conf</code> 导入内容</p></blockquote><pre><code class="Bash">echo 'LANG=en_US.UTF-8' &gt; /etc/locale.conf</code></pre><h2 id="设置主机名"><a href="#设置主机名" class="headerlink" title="设置主机名"></a>设置主机名</h2><pre><code class="Bash">vim /etc/hostname               #加入你想为主机取的主机名</code></pre><h2 id="接下来在-x2F-etc-x2F-hosts设置与其匹配的条目。"><a href="#接下来在-x2F-etc-x2F-hosts设置与其匹配的条目。" class="headerlink" title="接下来在/etc/hosts设置与其匹配的条目。"></a>接下来在/etc/hosts设置与其匹配的条目。</h2><pre><code class="Bash">vim /etc/hosts</code></pre><pre><code class="Bash">127.0.0.1   localhost::1         localhost127.0.1.1   archname</code></pre><h2 id="编辑resolv-conf，删除已有条目，并将如下内容加入其中，并固化文件"><a href="#编辑resolv-conf，删除已有条目，并将如下内容加入其中，并固化文件" class="headerlink" title="编辑resolv.conf，删除已有条目，并将如下内容加入其中，并固化文件"></a>编辑resolv.conf，删除已有条目，并将如下内容加入其中，并固化文件</h2><pre><code class="Bash">vim /etc/resolv.conf</code></pre><pre><code class="Bash">nameserver 8.8.8.8nameserver 2001:4860:4860::8888nameserver 8.8.4.4nameserver 2001:4860:4860::8844</code></pre><pre><code class="Bash">chattr +i /etc/resolv.conf</code></pre><h2 id="为-root-用户设置密码"><a href="#为-root-用户设置密码" class="headerlink" title="为 root 用户设置密码"></a>为 root 用户设置密码</h2><pre><code class="Bash">passwd root</code></pre><h2 id="安装微码"><a href="#安装微码" class="headerlink" title="安装微码"></a>安装微码</h2><pre><code class="Bash">pacman -S intel-ucode           #Intelpacman -S amd-ucode             #AMD</code></pre><h2 id="安装引导程序"><a href="#安装引导程序" class="headerlink" title="安装引导程序"></a>安装引导程序</h2><pre><code class="Bash">pacman -S grub efibootmgr       #grub是启动引导器，efibootmgr被 grub 脚本用来将启动项写入 NVRAM。</code></pre><h1 id="配置内核hook"><a href="#配置内核hook" class="headerlink" title="配置内核hook"></a>配置内核hook</h1><pre><code class="Bash">vim /etc/mkinitcpio.conf</code></pre><blockquote><p>删掉fsck(我们不用ext3/4,所以不需要), 加入zfs</p></blockquote><pre><code class="Bash">HOOKS=(base udev autodetect modconf kms keyboard keymap consolefont block filesystems zfs)</code></pre><pre><code class="Bash">mkinitcpio -P</code></pre><h1 id="开启zfs服务"><a href="#开启zfs服务" class="headerlink" title="开启zfs服务"></a>开启zfs服务</h1><pre><code class="Bash">systemctl enable zfs.target zfs-import-cache zfs-mount zfs-import.target</code></pre><h1 id="修复GRUB的bug，生成引导"><a href="#修复GRUB的bug，生成引导" class="headerlink" title="修复GRUB的bug，生成引导"></a>修复GRUB的bug，生成引导</h1><blockquote><p>修复grub的bug</p></blockquote><pre><code class="Bash">vim /etc/grub.d/10_linux</code></pre><blockquote><p>把以下行换成下面一行</p></blockquote><pre><code class="Bash">rpool=`${grub_probe} --device ${GRUB_DEVICE} --target=fs_label 2&gt;/dev/null || true`</code></pre><blockquote><p>改成</p></blockquote><pre><code class="Bash">rpool=`zdb -l ${GRUB_DEVICE} | grep " name:" | cut -d\' -f2`</code></pre><h2 id="生成引导"><a href="#生成引导" class="headerlink" title="生成引导"></a>生成引导</h2><pre><code class="Bash">grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=Archgrub-mkconfig -o /boot/grub/grub.cfg</code></pre><h1 id="准备非-root-用户"><a href="#准备非-root-用户" class="headerlink" title="准备非 root 用户"></a>准备非 root 用户</h1><pre><code class="Bash">useradd -m -G wheel -s /bin/fish testuser  #wheel附加组可sudo，以root用户执行命令 -m同时创建用户家目录</code></pre><blockquote><p>设置新用户 testuser 的密码</p></blockquote><pre><code class="Bash">passwd testuser</code></pre><blockquote><p>编辑 sudoers 配置文件</p></blockquote><pre><code class="Bash">EDITOR=vim visudo              #需要以 root 用户运行 visudo 命令</code></pre><blockquote><p>找到下面这样的一行，把前面的注释符号 # 去掉，:wq 保存并退出即可。</p></blockquote><pre><code class="Bash">#%wheel ALL=(ALL) ALL</code></pre><h1 id="完成安装，重启"><a href="#完成安装，重启" class="headerlink" title="完成安装，重启"></a>完成安装，重启</h1><pre><code class="Bash">exitumount /mnt/efizfs umount zroot/arch          # 卸载datasetzfs umount zhome/homezpool export zroot             # export是导出池，相当于卸载池zpool export zhomezfs umount -areboot</code></pre><h1 id="开启swap"><a href="#开启swap" class="headerlink" title="开启swap"></a>开启swap</h1><h2 id="先在zroot池中建立swap的dataset"><a href="#先在zroot池中建立swap的dataset" class="headerlink" title="先在zroot池中建立swap的dataset"></a>先在zroot池中建立swap的dataset</h2><blockquote><p>我由于要编译rom，所以这里示例开16G swap</p></blockquote><pre><code class="Bash">zfs create -V 16G zroot/swap</code></pre><h2 id="格式化swap"><a href="#格式化swap" class="headerlink" title="格式化swap"></a>格式化swap</h2><blockquote><p>/dev/zvol 是指定zfs卷</p></blockquote><pre><code class="Bash">mkswap -f /dev/zvol/zroot/swap</code></pre><h2 id="在fstab中加入swap"><a href="#在fstab中加入swap" class="headerlink" title="在fstab中加入swap"></a>在fstab中加入swap</h2><pre><code class="Bash">vim /etc/fstab/dev/zvol/zroot/swap none swap defaults 0 0</code></pre><h2 id="激活swap"><a href="#激活swap" class="headerlink" title="激活swap"></a>激活swap</h2><pre><code class="Bash">swapon -av</code></pre><h1 id="今后重装nvme后的处理"><a href="#今后重装nvme后的处理" class="headerlink" title="今后重装nvme后的处理"></a>今后重装nvme后的处理</h1><blockquote><p>在今后如果重装了nvme，但是依然保留zhome的池和文件<br>那么按以下方法可以快速导入已存在的zhome池并完成重装</p></blockquote><blockquote><p>创建nvme的zroot池后</p></blockquote><pre><code class="Bash">zpool create -f -o ashift=12           \             -O acltype=posixacl       \             -O relatime=on            \             -O xattr=sa               \             -O dnodesize=legacy       \             -O normalization=formD    \             -O mountpoint=none        \             -O canmount=off           \             -O devices=off            \             -O compression=lz4        \             -R /mnt                   \             zroot /dev/nvme0n1p2</code></pre><blockquote><p>创建zroot上的dataset并挂载</p></blockquote><pre><code class="Bash">zfs create -o mountpoint=/ -o canmount=noauto zroot/archzfs mount zroot/arch</code></pre><blockquote><p>导入上zhome</p></blockquote><pre><code class="Bash">zpool import zhome -R /mntzfs mount zhome/home</code></pre><blockquote><p>后面就是正常的挂载efi什么的，生成fstab，等后续操作</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
            <tag> openzfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo&amp;Github--website</title>
      <link href="/posts/2023/02/18/Hexo-Github/"/>
      <url>/posts/2023/02/18/Hexo-Github/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://pic.imgdb.cn/item/63f00eb2f144a01007cf643e.png" alt="Hexo" loading="lazy"></p><blockquote><p>Hexo: 快速、简洁且高效的博客框架<br>如何无成本搭建个人网站？<br>Linux上的操作步骤介绍</p></blockquote><span id="more"></span><hr><h1 id="在Github上创建一个项目-命名固定格式"><a href="#在Github上创建一个项目-命名固定格式" class="headerlink" title="在Github上创建一个项目(命名固定格式)"></a>在Github上创建一个项目(命名固定格式)</h1><blockquote><p>仓库格式为： 用户名.github.io<br>此为固定写法，不要乱写</p></blockquote><blockquote><p>安装Git并设置</p></blockquote><pre><code class="Bash">sudo pacman -S git</code></pre><blockquote><p>设置<code>user.name</code>和<code>user.email</code>配置信息</p></blockquote><pre><code class="Bash">git config --global user.name "你的GitHub用户名"git config --global user.email "你的GitHub注册邮箱"</code></pre><blockquote><p>生成ssh密钥文件</p></blockquote><pre><code class="Bash">ssh-keygen -t rsa -C "你的GitHub注册邮箱"</code></pre><blockquote><p>找到生成的<code>~/.ssh</code>的文件夹中的<code>id_rsa.pub</code>密钥，将内容全部复制<br>进入<a href="https://github.com/settings/keys">Github setting keys</a>, 并点击<code>New SSH Key</code><br>标题任意，把复制的内容粘入keys内，最后点添加</p></blockquote><h2 id="检查是否设置正确"><a href="#检查是否设置正确" class="headerlink" title="检查是否设置正确"></a>检查是否设置正确</h2><pre><code class="Bash">ssh git@github.com</code></pre><blockquote><p>若成功则会提示<br>Hi 你的用户名! You’ve successfully authenticated，</p></blockquote><blockquote><p>如果提示22端口连接不上，可以在~.ssh/config里加入以下内容换成443端口</p></blockquote><pre><code class="Bash">Host github.com    HostName ssh.github.com    User git    Port 443</code></pre><h1 id="安装Nodejs"><a href="#安装Nodejs" class="headerlink" title="安装Nodejs"></a>安装Nodejs</h1><pre><code class="Bash">sudo pacman -S nodejs npm</code></pre><h1 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h1><blockquote><p>首先我们要新建一个文件夹，命名自好<br>比如我们先在home目录新建Hexo</p></blockquote><pre><code class="Bash">mkdir ~/Hexo</code></pre><blockquote><p>然后cd进去该文件夹</p></blockquote><pre><code class="Bash">cd Hexo</code></pre><blockquote><p>使用npm命令安装Hexo</p></blockquote><pre><code class="Bash">sudo npm install -g hexo-cli</code></pre><blockquote><p>安装完成后，初始化我们的博客</p></blockquote><pre><code class="Bash">hexo init blog</code></pre><h2 id="检测我们的网站雏形"><a href="#检测我们的网站雏形" class="headerlink" title="检测我们的网站雏形"></a>检测我们的网站雏形</h2><blockquote><p>通过以下命令创建且在本地建立server</p></blockquote><pre><code class="Bash">hexo new test   #新建文章 testhexo g          #更迭文件hexo s          #本地server</code></pre><blockquote><p>进入<code>localhost:4000</code>查看博客</p></blockquote><h2 id="常用Hexo命令"><a href="#常用Hexo命令" class="headerlink" title="常用Hexo命令"></a>常用Hexo命令</h2><pre><code class="Bash">npm install hexo -g  #安装Hexonpm update hexo -g   #升级hexo init            #初始化博客hexo n "文章名"       #新建文章hexo clean           #清除缓存hexo g               #更迭文件hexo s               #本地server预览hexo d               #部署</code></pre><h1 id="推送网站"><a href="#推送网站" class="headerlink" title="推送网站"></a>推送网站</h1><h2 id="首先我们要明确我们要改的-config-是什么"><a href="#首先我们要明确我们要改的-config-是什么" class="headerlink" title="首先我们要明确我们要改的 config 是什么"></a>首先我们要明确我们要改的 config 是什么</h2><blockquote><p>Hexo文件下的<code>_config.yml</code>是<code>站点</code>的配置<br>而themes下的某主题的<code>_config.yml</code>只是对主题的修改</p></blockquote><h2 id="关联Hexo与GitHub-打开-站点config-翻到最后"><a href="#关联Hexo与GitHub-打开-站点config-翻到最后" class="headerlink" title="关联Hexo与GitHub,打开 站点config ,翻到最后"></a>关联Hexo与GitHub,打开 站点config ,翻到最后</h2><pre><code class="Bash">deploy:type: gitrepo: 这里填入你之前在GitHub上创建仓库的完整路径，记得加上 .gitbranch: master</code></pre><blockquote><p>repo格式为</p></blockquote><pre><code class="Bash">git@github.com:/用户名/用户名(小写).github.io.git</code></pre><h2 id="安装Git部署插件"><a href="#安装Git部署插件" class="headerlink" title="安装Git部署插件"></a>安装Git部署插件</h2><pre><code class="Bash">npm install hexo-deployer-git --save</code></pre><h1 id="网站部署完成"><a href="#网站部署完成" class="headerlink" title="网站部署完成"></a>网站部署完成</h1><blockquote><p>通过<code>hexo d</code>部署网站，<code>用户名.github.io</code>应可正常访问</p></blockquote><pre><code class="Bash">hexo cleanhexo ghexo d</code></pre><h1 id="绑定域名-如果你有，且你需要"><a href="#绑定域名-如果你有，且你需要" class="headerlink" title="绑定域名(如果你有，且你需要)"></a>绑定域名(如果你有，且你需要)</h1><h2 id="到你的域名服务商处解析域名到github"><a href="#到你的域名服务商处解析域名到github" class="headerlink" title="到你的域名服务商处解析域名到github"></a>到你的域名服务商处解析域名到github</h2><ul><li>记录类型<code>CNAME</code>,主机记录<code>www</code>,记录值<code>用户名.github.io</code></li><li>记录类型<code>CNAME</code>,主机记录<code>@</code>,记录值<code>www.你的域名</code></li></ul><h2 id="到github绑定你的域名"><a href="#到github绑定你的域名" class="headerlink" title="到github绑定你的域名"></a>到github绑定你的域名</h2><p>登录GitHub，进入之前创建的仓库，点击settings，设置Custom domain，输入你的域名<br><code>www.你的域名</code></p><h2 id="在source下创建CNAME文件"><a href="#在source下创建CNAME文件" class="headerlink" title="在source下创建CNAME文件"></a>在source下创建CNAME文件</h2><p>打开CNAME文件后只输入你的域名即可<br>如果带有www，那么以后访问的时候必须带有www完整的域名才可以访问，但如果不带有www，以后访问的时候带不带www都可以访问。</p><blockquote><p>再次部署就可以通过域名访问你的网站了</p></blockquote><h1 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h1><p><a href="https://hexo.io/themes/">Hexo主题库</a></p><blockquote><p>主题的调用方式有两种<br>一定不要忘记看主题的github页的介绍和用法！！！</p></blockquote><ul><li>一是手动下载后放在themes里，直接改主题的<code>_config.yml</code>，clone你要的主题放在<code>themes/</code>下，打开<code>站点config.yml</code>修改主题为对应该的主题</li><li>二是通过<code>npm</code>直接下载(主题作者一般会讲是哪个包)，它会下载在<code>node_modules</code>内，找到它(一般hexo-theme开头)并把里面的<code>_config.主题名.yml</code>(具体在哪要看主题的介绍)的文件复制到Hexo的目录下与<code>_config.yml</code>同目录</li></ul><h1 id="其他以及注意事项"><a href="#其他以及注意事项" class="headerlink" title="其他以及注意事项"></a>其他以及注意事项</h1><ul><li>写文章时用的是Markdown语法，本文不讲，请自行学习</li><li>github上尽可能不要上传图片，请自行调用自己常用的图床</li></ul>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> github </tag>
            
            <tag> website </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chromium Google Sync</title>
      <link href="/posts/2023/02/06/Chromium-Google-Sync/"/>
      <url>/posts/2023/02/06/Chromium-Google-Sync/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>为Chromium开启Google的同步功能</p></blockquote><span id="more"></span><hr><blockquote><p>本文来源 <a href="https://nyac.at/posts/google-sync-in-chromium">凌莞喵</a></p></blockquote><hr><blockquote><p>具体前提和起因就不细讲了，<br>本文具体讲需要做哪些步骤</p></blockquote><h1 id="加入-Chromium-dev-用户组"><a href="#加入-Chromium-dev-用户组" class="headerlink" title="加入 Chromium dev 用户组"></a>加入 Chromium dev 用户组</h1><p><a href="https://groups.google.com/a/chromium.org/forum/?fromgroups#!forum/chromium-dev">Chromium-dev</a><br><a href="https://groups.google.com/u/1/a/chromium.org/g/google-browser-signin-testaccounts">Google browser sign-in test account</a></p><h1 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h1><blockquote><p>进入<a href="https://cloud.google.com/console">Google 开发者中心</a>,创建一个新的项目</p></blockquote><p><img src="https://pic.imgdb.cn/item/63e0055d4757feff333c26b9.png" alt="1" loading="lazy"></p><blockquote><p>进入左边的 API 和服务 &gt; OAuth 同意屏幕先初始化配置自己的应用<br>User Type 选择<code>外部</code><br>接下来的名称啥的都可以随意填写<br>在<code>测试用户</code>页面，添加自己的账户</p></blockquote><p><img src="https://pic.imgdb.cn/item/63e005a74757feff333c72bf.png" alt="2" loading="lazy"></p><h1 id="添加-API"><a href="#添加-API" class="headerlink" title="添加 API"></a>添加 API</h1><blockquote><p>在<code>库</code>内搜索并添加以下API</p></blockquote><p><img src="https://pic.imgdb.cn/item/63e006054757feff333cd01c.png" alt="3" loading="lazy"><br><img src="https://pic.imgdb.cn/item/63e0061a4757feff333ce9e5.png" alt="4" loading="lazy"></p><blockquote><ul><li>Admin SDK API</li><li>Chrome Web Store API</li><li>Cloud Search API</li><li>Google Drive API</li><li>Safe Browsing API</li><li>Time Zone API<br>BigQuery API<br>BigQuery Storage API<br>Cloud Datastore API<br>Cloud Debugger API<br>Cloud Logging API<br>Cloud Monitoring API<br>Cloud SQL<br>Cloud Storage<br>Cloud Trace API<br>Google Cloud APIs<br>Google Cloud Storage JSON API<br>Service Management API<br>Service Usage API<br>VM Migration API</li></ul></blockquote><h1 id="获取-API-密钥"><a href="#获取-API-密钥" class="headerlink" title="获取 API 密钥"></a>获取 API 密钥</h1><blockquote><p>进入<code>凭据</code>页面，首先创建一个 API 密钥<br>然后创建 OAuth 客户端 ID，应用类型选择桌面应用</p></blockquote><p><img src="https://pic.imgdb.cn/item/63e006334757feff333d0464.png" alt="5" loading="lazy"></p><h1 id="添加密钥到环境变量"><a href="#添加密钥到环境变量" class="headerlink" title="添加密钥到环境变量"></a>添加密钥到环境变量</h1><blockquote><p>把以下内容加入自己的key后，写入environment中</p></blockquote><pre><code class="Bash">sudo vim /etc/environment</code></pre><pre><code class="Bash">export GOOGLE_API_KEY=API 密钥的「键」export GOOGLE_DEFAULT_CLIENT_ID=客户端 IDexport GOOGLE_DEFAULT_CLIENT_SECRET=客户端密钥</code></pre><hr><blockquote><p>注销再登录即可</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome </tag>
            
            <tag> Chromium </tag>
            
            <tag> Google </tag>
            
            <tag> Sync </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clash&amp;Rules Providers</title>
      <link href="/posts/2023/01/30/Clash-Rules-Providers/"/>
      <url>/posts/2023/01/30/Clash-Rules-Providers/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Clash规则及格式如何写以及一些基本的刚需规则</p></blockquote><span id="more"></span><hr><h1 id="安装Clash-Premium"><a href="#安装Clash-Premium" class="headerlink" title="安装Clash Premium"></a>安装Clash Premium</h1><pre><code class="Bash">yay -S clash-premium-bin</code></pre><h1 id="配置编写"><a href="#配置编写" class="headerlink" title="配置编写"></a>配置编写</h1><h2 id="基本设置"><a href="#基本设置" class="headerlink" title="基本设置"></a>基本设置</h2><details><summary>设置以及开启一些基本功能</summary><pre><code class="Bash">port: 7890socks-port: 7891# HTTP(S) and SOCKS4(A)/SOCKS5 server on the same port#mixed-port: 7892# Transparent proxy server port for Linux and macOS (Redirect TCP and TProxy UDP)#redir-port: 7893# Transparent proxy server port for Linux (TProxy TCP and TProxy UDP)tproxy-port: 7894allow-lan: truemode: Rulelog-level: infoexternal-controller: 127.0.0.1:9090tun:  enable: true  stack: system # 或 gvisor  dns-hijack:    - any:53    - tcp://any:53  auto-route: true # auto set global route  auto-detect-interface: true # conflict with interface-namedns:  enable: true  nameserver:    - 223.5.5.5    - 119.29.29.29  fallback:    - https://doh.buzz:8000/dns-query    - https://doh.beauty:8000/dns-query    - https://cloudflare-dns.com/dns-query    - tls://1.1.1.1:853    - tls://1.0.0.1:853    - https://1.1.1.1/dns-query    - https://1.0.0.1/dns-query    - tls://8.8.8.8:853    - tls://8.8.4.4:853    - https://dns.google/dns-query    - https://dns.twnic.tw/dns-query  fallback-filter:    geoip: true    geoip-code: CN    ipcidr:      - 240.0.0.0/4    domain:      - +.google.com      - +.facebook.com      - +.youtube.com  nameserver-policy: ~cfw-bypass:  - qq.com  - music.163.com  - "*.music.126.net"  - localhost  - 127.*  - 10.*  - 172.16.*  - 172.17.*  - 172.18.*  - 172.19.*  - 172.20.*  - 172.21.*  - 172.22.*  - 172.23.*  - 172.24.*  - 172.25.*  - 172.26.*  - 172.27.*  - 172.28.*  - 172.29.*  - 172.30.*  - 172.31.*  - 192.168.*  - &lt;local&gt;cfw-latency-timeout: 5000</code></pre></details><h2 id="节点设置"><a href="#节点设置" class="headerlink" title="节点设置"></a>节点设置</h2><details><summary>设置基本的节点和分组</summary><pre><code class="Bash">proxies:这里覆盖上你所有的节点配置proxy-groups:  - name: 🌏 MAIN    type: select    proxies:      - 你的最佳的几个节点  - name: 💠 AllInOne    type: select    proxies:      - 🌏 MAIN      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🔰 机场1    type: select    proxies:      - 节点  - name: 🔰 机场2    type: select    proxies:      - 节点  - name: 🔰 机场3    type: select    proxies:      - 节点  - name: 🧱 GFW    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 📯 Telegram    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🇨🇳 Tld-Not-CN    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🌀 Google    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🎥 Stream    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🐟 MIS    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🎮 Steam-Download    type: select    proxies:      - DIRECT      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3  - name: 🇨🇳 China    type: select    proxies:      - DIRECT      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3</code></pre></details><h2 id="设置规则提供列表"><a href="#设置规则提供列表" class="headerlink" title="设置规则提供列表"></a>设置规则提供列表</h2><details><summary>rule-providers加到groups后面</summary><pre><code class="Bash">rule-providers:  reject:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"    path: ./ruleset/reject.yaml    interval: 86400  icloud:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"    path: ./ruleset/icloud.yaml    interval: 86400  apple:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"    path: ./ruleset/apple.yaml    interval: 86400  google:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"    path: ./ruleset/google.yaml    interval: 86400  proxy:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"    path: ./ruleset/proxy.yaml    interval: 86400  direct:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"    path: ./ruleset/direct.yaml    interval: 86400  private:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"    path: ./ruleset/private.yaml    interval: 86400  gfw:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"    path: ./ruleset/gfw.yaml    interval: 86400  greatfire:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/greatfire.txt"    path: ./ruleset/greatfire.yaml    interval: 86400  tld-not-cn:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"    path: ./ruleset/tld-not-cn.yaml    interval: 86400  telegramcidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"    path: ./ruleset/telegramcidr.yaml    interval: 86400  cncidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"    path: ./ruleset/cncidr.yaml    interval: 86400  lancidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"    path: ./ruleset/lancidr.yaml    interval: 86400  applications:    type: http    behavior: classical    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"    path: ./ruleset/applications.yaml    interval: 86400</code></pre></details><h2 id="手动加入一些常用的规则"><a href="#手动加入一些常用的规则" class="headerlink" title="手动加入一些常用的规则"></a>手动加入一些常用的规则</h2><h3 id="rule-providers需要指定分流"><a href="#rule-providers需要指定分流" class="headerlink" title="rule-providers需要指定分流"></a>rule-providers需要指定分流</h3><details><summary>rules加到rule-providers后面</summary><pre><code class="Bash">rules: - DOMAIN,clash.razord.top,DIRECT - DOMAIN,yacd.haishan.me,DIRECT - RULE-SET,applications,DIRECT - RULE-SET,private,DIRECT - RULE-SET,reject,REJECT - RULE-SET,icloud,DIRECT - RULE-SET,apple,DIRECT - RULE-SET,google,🌀 Google - RULE-SET,proxy,💠 AllInOne - RULE-SET,gfw,🧱 GFW - RULE-SET,greatfire,🧱 GFW - RULE-SET,tld-not-cn,🇨🇳 Tld-Not-CN - RULE-SET,direct,DIRECT - RULE-SET,lancidr,DIRECT - RULE-SET,cncidr,DIRECT - RULE-SET,telegramcidr,📯 Telegram - MATCH,🐟 MIS</code></pre></details><h3 id="steam下载走国内服务器"><a href="#steam下载走国内服务器" class="headerlink" title="steam下载走国内服务器"></a>steam下载走国内服务器</h3><details><summary>加到rules里面</summary><pre><code class="Bash"> - DOMAIN-SUFFIX,steamgames.com,DIRECT - DOMAIN-SUFFIX,steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe.steamcontent.tnkjmec.com,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.eccdnx.com,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.bscstorage.net,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.pinyuncloud.com,🎮 Steam-Download - DOMAIN-SUFFIX,dl.steam.clngaa.com,🎮 Steam-Download - DOMAIN-SUFFIX,cdn.mileweb.cs.steampowered.com.8686c.com,🎮 Steam-Download - DOMAIN-SUFFIX,xz.pphimalayanrt.com,🎮 Steam-Download - DOMAIN-SUFFIX,edge.steam-dns.top.comcast.net,🎮 Steam-Download - DOMAIN-SUFFIX,edgecast.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,google.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,google2.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,level3.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.eca.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.naeu.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.ru.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.apac.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe-kr.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe-partner.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,f3b7q2p3.ssl.hwcdn.net,🎮 Steam-Download - DOMAIN-SUFFIX,telus.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.on.net,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.orcon.net.nz,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.slingshot.co.nz,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.webra.ru,🎮 Steam-Download</code></pre></details><h1 id="总体模板"><a href="#总体模板" class="headerlink" title="总体模板"></a>总体模板</h1><details><summary>换上自己的节点即可</summary><pre><code class="Bash">port: 7890socks-port: 7891# Transparent proxy server port for Linux and macOS (Redirect TCP and TProxy UDP)# redir-port: 7892# Transparent proxy server port for Linux (TProxy TCP and TProxy UDP)tproxy-port: 7893# HTTP(S) and SOCKS4(A)/SOCKS5 server on the same portmixed-port: 7894allow-lan: truemode: Rulelog-level: infoexternal-controller: 127.0.0.1:9090dns:  enable: true  listen: 0.0.0.0:53  enhanced-mode: fake-ip  nameserver:    - 8.8.8.8    - 114.114.114.114  fallback:    - 8.8.8.8tun:  enable: true  stack: system # 或 gvisor  dns-hijack:    - any:53    - tcp://any:53  auto-route: true # auto set global route  auto-detect-interface: true # conflict with interface-namecfw-bypass:  - qq.com  - music.163.com  - "*.music.126.net"  - localhost  - 127.*  - 10.*  - 172.16.*  - 172.17.*  - 172.18.*  - 172.19.*  - 172.20.*  - 172.21.*  - 172.22.*  - 172.23.*  - 172.24.*  - 172.25.*  - 172.26.*  - 172.27.*  - 172.28.*  - 172.29.*  - 172.30.*  - 172.31.*  - 192.168.*  - &lt;local&gt;cfw-latency-timeout: 5000proxies:这里覆盖上你的节点配置proxy-groups:  - name: 🌏 MAIN    type: select    proxies:      - 你的最佳的几个节点  - name: 💠 AllInOne    type: select    proxies:      - 🌏 MAIN      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🔰 机场1    type: select    proxies:      - 节点  - name: 🔰 机场2    type: select    proxies:      - 节点  - name: 🔰 机场3    type: select    proxies:      - 节点  - name: 🧱 GFW    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 📯 Telegram    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🇨🇳 Tld-Not-CN    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🌀 Google    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🎥 Stream    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🐟 MIS    type: select    proxies:      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3      - DIRECT  - name: 🎮 Steam-Download    type: select    proxies:      - DIRECT      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3  - name: 🇨🇳 China    type: select    proxies:      - DIRECT      - 💠 AllInOne      - 🔰 机场1      - 🔰 机场2      - 🔰 机场3rule-providers:  reject:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"    path: ./ruleset/reject.yaml    interval: 86400  icloud:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"    path: ./ruleset/icloud.yaml    interval: 86400  apple:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"    path: ./ruleset/apple.yaml    interval: 86400  google:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"    path: ./ruleset/google.yaml    interval: 86400  proxy:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"    path: ./ruleset/proxy.yaml    interval: 86400  direct:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"    path: ./ruleset/direct.yaml    interval: 86400  private:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"    path: ./ruleset/private.yaml    interval: 86400  gfw:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"    path: ./ruleset/gfw.yaml    interval: 86400  greatfire:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/greatfire.txt"    path: ./ruleset/greatfire.yaml    interval: 86400  tld-not-cn:    type: http    behavior: domain    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"    path: ./ruleset/tld-not-cn.yaml    interval: 86400  telegramcidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"    path: ./ruleset/telegramcidr.yaml    interval: 86400  cncidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"    path: ./ruleset/cncidr.yaml    interval: 86400  lancidr:    type: http    behavior: ipcidr    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"    path: ./ruleset/lancidr.yaml    interval: 86400  applications:    type: http    behavior: classical    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"    path: ./ruleset/applications.yaml    interval: 86400rules: - DOMAIN-SUFFIX,live-video.net,🎥 Stream - DOMAIN-SUFFIX,steamgames.com,DIRECT - DOMAIN-SUFFIX,steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe.steamcontent.tnkjmec.com,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.eccdnx.com,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.bscstorage.net,🎮 Steam-Download - DOMAIN-SUFFIX,st.dl.pinyuncloud.com,🎮 Steam-Download - DOMAIN-SUFFIX,dl.steam.clngaa.com,🎮 Steam-Download - DOMAIN-SUFFIX,cdn.mileweb.cs.steampowered.com.8686c.com,🎮 Steam-Download - DOMAIN-SUFFIX,xz.pphimalayanrt.com,🎮 Steam-Download - DOMAIN-SUFFIX,edge.steam-dns.top.comcast.net,🎮 Steam-Download - DOMAIN-SUFFIX,edgecast.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,google.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,google2.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,level3.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.eca.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.naeu.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.ru.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.apac.qtlglb.com,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe-kr.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe-partner.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,steampipe.akamaized.net,🎮 Steam-Download - DOMAIN-SUFFIX,f3b7q2p3.ssl.hwcdn.net,🎮 Steam-Download - DOMAIN-SUFFIX,telus.cdn.steampipe.steamcontent.com,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.on.net,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.orcon.net.nz,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.slingshot.co.nz,🎮 Steam-Download - DOMAIN-SUFFIX,steam.cdn.webra.ru,🎮 Steam-Download - DOMAIN,clash.razord.top,DIRECT - DOMAIN,yacd.haishan.me,DIRECT - RULE-SET,applications,DIRECT - RULE-SET,private,DIRECT - RULE-SET,reject,REJECT - RULE-SET,icloud,DIRECT - RULE-SET,apple,DIRECT - RULE-SET,google,🌀 Google - RULE-SET,proxy,💠 AllInOne - RULE-SET,gfw,🧱 GFW - RULE-SET,greatfire,🧱 GFW - RULE-SET,tld-not-cn,🇨🇳 Tld-Not-CN - RULE-SET,direct,DIRECT - RULE-SET,lancidr,DIRECT - RULE-SET,cncidr,DIRECT - RULE-SET,telegramcidr,📯 Telegram - MATCH,🐟 MIS</code></pre></details><h1 id="我提供的配置"><a href="#我提供的配置" class="headerlink" title="我提供的配置"></a>我提供的配置</h1><blockquote><p>如果觉得延迟很高，很正常，毕竟是免费提供，如果觉得我怎么不提供的更好的，请删掉不用</p></blockquote><p><a href="https://www.moichi.cn/others/">点击查看配置页面</a></p>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clash </tag>
            
            <tag> proxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Protonhax</title>
      <link href="/posts/2023/01/30/Protonhax/"/>
      <url>/posts/2023/01/30/Protonhax/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>使软件运行在与游戏运行相同的proton容器下，比如游戏修改器<br><a href="https://github.com/aoleg94/protonhax">github项目地址</a></p></blockquote><span id="more"></span><hr><h1 id="安装protonhax"><a href="#安装protonhax" class="headerlink" title="安装protonhax"></a>安装protonhax</h1><p>Arch Linux从aur安装</p><pre><code class="Bash">yay -S protonhax</code></pre><h1 id="设置启动项"><a href="#设置启动项" class="headerlink" title="设置启动项"></a>设置启动项</h1><p>右键你的steam游戏<br>在launch option里加入</p><pre><code class="Bash">protonhax init %COMMAND%</code></pre><p>如果你用prime-run，加在前面就行</p><h1 id="运行方式"><a href="#运行方式" class="headerlink" title="运行方式"></a>运行方式</h1><h2 id="找到你运行的游戏ID"><a href="#找到你运行的游戏ID" class="headerlink" title="找到你运行的游戏ID"></a>找到你运行的游戏ID</h2><pre><code class="Bash">protonhax ls</code></pre><blockquote><p>如我运行Dishonored 2，则是403640</p></blockquote><h2 id="在游戏的同一容器内运行程序"><a href="#在游戏的同一容器内运行程序" class="headerlink" title="在游戏的同一容器内运行程序"></a>在游戏的同一容器内运行程序</h2><pre><code class="Bash">protonhax run &lt;gameid&gt; &lt;path/program&gt;</code></pre><blockquote><p>如我需要运行Dishonored 2修改器，则是<code>protonhax run 403640 &lt;修改器路径&gt;</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
            <tag> proton </tag>
            
            <tag> wine </tag>
            
            <tag> steam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Arch Compile Env</title>
      <link href="/posts/2023/01/30/Arch-Compile-Env/"/>
      <url>/posts/2023/01/30/Arch-Compile-Env/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Arch Linux编译Android rom的环境</p></blockquote><span id="more"></span><hr><h1 id="环境包准备"><a href="#环境包准备" class="headerlink" title="环境包准备"></a>环境包准备</h1><p>首先，我们得用bash, 像zsh这样的会在out过程出错，只推荐在编译时至少用bash<br>先声明自己</p><pre><code class="Bash">git config --global user.name "$urusername"git config --global user.email "$urmailaddr"</code></pre><p>其次，安装需要的基本的包</p><pre><code class="Bash">yay -S base-devel multilib-devel gcc repo git gnupg gperf sdl wxwidgets-common wxwidgets-gtk2 squashfs-tools curl ncurses zlib schedtool perl-switch zip unzip libxslt bc rsync ccache lib32-zlib lib32-ncurses lib32-readline ncurses5-compat-libs lib32-ncurses5-compat-libs ttf-dejavu lib32-gcc-libs flex bison  xml2 lzop pngcrush imagemagick lineageos-devel aosp-devel libxcrypt-compat</code></pre><h1 id="MIX3-Devices-Trees"><a href="#MIX3-Devices-Trees" class="headerlink" title="MIX3 Devices Trees"></a>MIX3 Devices Trees</h1><h2 id="Lineage-based"><a href="#Lineage-based" class="headerlink" title="Lineage-based"></a>Lineage-based</h2><pre><code class="Bash">git clone https://github.com/LineageOS/android_device_xiaomi_perseus.git -b lineage-20 device/xiaomi/perseusgit clone https://github.com/LineageOS/android_device_xiaomi_sdm845-common.git -b lineage-20  device/xiaomi/sdm845-commongit clone https://github.com/LineageOS/android_kernel_xiaomi_sdm845.git -b lineage-20 kernel/xiaomi/sdm845git clone https://github.com/LineageOS/android_hardware_xiaomi.git -b lineage-20 hardware/xiaomigit clone https://gitlab.com/the-muppets/proprietary_vendor_xiaomi.git vendor/xiaomi</code></pre><h2 id="My-Edited"><a href="#My-Edited" class="headerlink" title="My Edited"></a>My Edited</h2><pre><code class="Bash">git clone https://github.com/MoichiLin/android_device_xiaomi_perseus.git device/xiaomi/perseusgit clone https://github.com/MoichiLin/android_device_xiaomi_sdm845-common.git device/xiaomi/sdm845-commongit clone https://github.com/MoichiLin/android_kernel_xiaomi_sdm845.git kernel/xiaomi/sdm845</code></pre><h2 id="Lolipuru-Edited"><a href="#Lolipuru-Edited" class="headerlink" title="Lolipuru Edited"></a>Lolipuru Edited</h2><pre><code class="Bash">git clone https://github.com/lolipuru/device_xiaomi_perseus.git device/xiaomi/perseusgit clone https://github.com/lolipuru/device_xiaomi_perseus-common.git device/xiaomi/sdm845-commongit clone https://github.com/lolipuru/kernel_xiaomi_perseus.git kernel/xiaomi/sdm845git clone https://github.com/lolipuru/vendor_xiaomi_perseus.git vendor/xiaomi</code></pre><h1 id="Basic-Edit"><a href="#Basic-Edit" class="headerlink" title="Basic Edit"></a>Basic Edit</h1><pre><code class="Bash"># Edit tree_name to rom_namemv device/xiaomi/perseus/&lt;t&gt;.dependencies device/xiaomi/perseus/&lt;r&gt;.dependenciesmv device/xiaomi/perseus/&lt;t&gt;_perseus.mk device/xiaomi/perseus/&lt;r&gt;_perseus.mkmv device/xiaomi/sdm845-common/&lt;t&gt;.dependencies device/xiaomi/sdm845-common/&lt;r&gt;.dependenciesvim device/xiaomi/perseus/&lt;r&gt;_perseus.mkvim device/xiaomi/perseus/AndroidProducts.mk----------# vim device/xiaomi/perseus/BoardConfig.mkBUILD_BROKEN_DUP_RULES := trueALLOW_MISSING_DEPENDENCIES := true# Add maintainer and other support, such as Cherish# add in lineage_perseus.mkCHERISH_VANILLA := trueTARGET_SUPPORTS_QUICK_TAP := trueCHERISH_BUILD_TYPE := UNOFFICIALPRODUCT_SYSTEM_DEFAULT_PROPERTIES += \    ro.cherish.maintainer=GayFuckingLilydess----------# Some Roms need to edit, if override or not support# vim device/xiaomi/sdm845-common/pocketmode/Android.mkLOCAL_PRIVATE_PLATFORM_APIS := false# vim device/xiaomi/sdm845-common/system.prop and deletero.com.android.dataroaming=true# livedisplayvim device/xiaomi/perseus/device.mkvim device/xiaomi/sdm845-common/sepolicy/vendor/hal_lineage_livedisplay_qti.tevim device/xiaomi/sdm845-common/sepolicy/vendor/file_contexts----------. build/envsetup.sh&nbsp;&amp;&amp; export USE_CCACHE=1 &amp;&amp; export CCACHE_EXEC=/usr/bin/ccache &amp;&amp; ccache -M 50G</code></pre>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
            <tag> compile </tag>
            
            <tag> building </tag>
            
            <tag> rom </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayfire&amp;Awesome-Wayland&amp;X11</title>
      <link href="/posts/2023/01/24/Wayfire-Awesome/"/>
      <url>/posts/2023/01/24/Wayfire-Awesome/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://pic.imgdb.cn/item/63e0271e4757feff3359b375.png" alt="Wayfire" title="Wayfire" loading="lazy"></p><blockquote><p>详细编写了wayfire和awesome的安装以及使用<br>包含有一系列的基础和必要软件的安装和使用方法，以及一些重要服务的配置</p></blockquote><span id="more"></span><hr><h1 id="Wayfire"><a href="#Wayfire" class="headerlink" title="Wayfire"></a>Wayfire</h1><p><code>Wayfire is a wayland compositor based on wlroots. It aims to create a customizable, extendable and lightweight environment without sacrificing its appearance.</code><br><code>Wayfire是一个基于wlroots的wayland合成器。它旨在创建一个可定制的、可扩展的、轻量级的环境，且不牺牲其外观。</code><br>官网 <a href="https://wayfire.org/">Wayfire</a><br>Github <a href="https://github.com/WayfireWM/wayfire">Wayfire</a></p><hr><blockquote><p>我的dotfiles文件(github)<br>    <a href="https://github.com/MoichiLin">我的dotfiles</a></p></blockquote><hr><h2 id="连网"><a href="#连网" class="headerlink" title="连网"></a>连网</h2><pre><code class="Bash">sudo systemctl enable --now NetworkManagernmcli dev wifi listnmcli dev wifi connect $WIFI-SSID password $WIFI-PASSWDnmcli dev wifi connect $WIFI-SSID password $WIFI-PASSWD hidden yes #连接隐藏wifi</code></pre><hr><h2 id="开启-32-位支持库"><a href="#开启-32-位支持库" class="headerlink" title="开启 32 位支持库"></a>开启 32 位支持库</h2><blockquote><p>编译pacman.conf<br>    去掉 <code>[multilib]</code> 一节中两行的注释，来开启 32 位库支持。</p></blockquote><pre><code class="Bash">sudo vim /etc/pacman.conf</code></pre><hr><h2 id="安装-yay"><a href="#安装-yay" class="headerlink" title="安装 yay"></a>安装 yay</h2><pre><code class="Bash">wget https://lvu.moichi.cn/res/yay-bin.pkg.tar.zstsudo pacman -U yay-bin.pkg.tar.zst</code></pre><hr><h2 id="安装Wayfire"><a href="#安装Wayfire" class="headerlink" title="安装Wayfire"></a>安装Wayfire</h2><blockquote><p>注意wayfire与wayfire-git的不同情况下的选择</p></blockquote><pre><code class="Bash">yay -S wayfire wayfire-plugin-extrayay -S wayfire-lily-git    #archlinuxcn 依云</code></pre><hr><h2 id="安装必要软件"><a href="#安装必要软件" class="headerlink" title="安装必要软件"></a>安装必要软件</h2><pre><code class="Bash">yay -S qt6-waylandyay -S qt5-waylandyay -S xorg-xwayland                                                   #xwaylandyay -S xdg-desktop-portal-wlrsudo pacman -S adobe-source-han-serif-cn-fonts wqy-zenhei              #安装几个开源中文字体 一般装上文泉驿就能解决大多wine应用中文方块的问题sudo pacman -S noto-fonts-cjk noto-fonts-emoji noto-fonts-extra        #安装谷歌开源字体及表情sudo pacman -S alsa-utils pipewire pipewire-alsa pipewire-jack wireplumber pipewire-pulse pavucontrol pamixer #pipewire声音及音量控制sudo pacman -S alsa-utils pulseaudio pulseaudio-alsa pavucontrol pulseaudio-bluetooth pavucontrol     #pluse声音及音量控制sudo pacman -S brightnessctl                                           #屏幕背光控制sudo pacman -S ntfs-3g                                                 #识别NTFS格式的硬盘sudo pacman -S ark p7zip unrar unarchiver lzop lrzip                   #解压工具sudo pacman -S git wget kate bind                                      #一些工具以下的包不在下面的合集中yay -S wl-gammactl                                                     #gamma,亮度,对比度sudo pacman -S bluez bluez-utils bluez-libs bluez-qt bluez-tools blueman bluedevil  #蓝牙</code></pre><details><summary>复制所有</summary><pre><code class="Bash">yay -S qt6-wayland qt5-wayland xorg-xwayland adobe-source-han-serif-cn-fonts wqy-zenhei ntfs-3g noto-fonts-cjk noto-fonts-emoji noto-fonts-extra alsa-utils pipewire pipewire-alsa pipewire-jack wireplumber pipewire-pulse pavucontrol brightnessctl git wget kate bind ark p7zip unrar unarchiver lzop lrzip</code></pre></details><hr><h2 id="一些刚需软件"><a href="#一些刚需软件" class="headerlink" title="一些刚需软件"></a>一些刚需软件</h2><pre><code class="Bash">sudo pacman -S fcitx5-im              #基础包组sudo pacman -S fcitx5-chinese-addons  #官方中文输入引擎sudo pacman -S fcitx5-material-color  #主题yay -S kitty python-pillow            #kitty 在wayland下支持ranger预览文件yay -S waybar                         #baryay -S grim slurp                     #截图yay -S wl-clipboard                   #剪贴板yay -S mako                           #通知yay -S wpaperd                        #壁纸。 可自动切换同路径下随机壁纸yay -S swaylock                       #锁屏yay -S wlogout                        #wlogout 可用来帐户登出，关机重启等操作yay -S kanshi                         #屏幕yay -S thunar gvfs gvfs-mtp thunar-archive-plugin file-roller   #文件管理器yay -S ranger ttf-nerd-fonts-symbols-1000-em-mono highlight atool   #终端文件管理器yay -S greetd greetd-tuigreet         #登录管理器以下的包不在下面的合集中yay -S mpvpaper                       #视频壁纸</code></pre><details><summary>复制所有</summary><pre><code class="Bash">yay -S fcitx5-im fcitx5-chinese-addons fcitx5-material-color kitty python-pillow waybar grim slurp wl-clipboard mako swaylock wlogout kanshi thunar gvfs gvfs-mtp thunar-archive-plugin file-roller ranger ttf-nerd-fonts-symbols-1000-em-mono highlight atool wpaperd greetd greetd-tuigreet</code></pre></details><hr><h2 id="其他软件"><a href="#其他软件" class="headerlink" title="其他软件"></a>其他软件</h2><pre><code class="Bash">yay -S clash-meta-bin                          #clashyay -S aria2                                      #aria2服务yay -S chromium gtk4 firefox                      #chromium firefoxyay -S icalingua++ telegram-desktop-bin           #QQ telegramyay -S youtube-music-bin                          #youtube-music带各种实用插件yay -S mpv nomacs kate                            #视频播放 图片查看 文本编辑yay -S obs-studio wlrobs-hg                       #OBSyay -S refind                                     #引导工具yay -S scrcpy                                     #投屏软件yay -S android-tools                              #adb工具yay -S gamemode steam                             #Steamyay -S dxvk-bin vkd3d vkd3d-proton-bin            #dx9,10,11,12 to vulkanyay -S vbam-wx fceux melonds-bin citra-qt-bin ffmpeg4.4 ryujinx-bin #GBA FC NDS 3DS SWITCH 模拟器yay -S virtualbox virtualbox-host-dkms virtualbox-guest-iso  #virtualboxyay -S virtualbox-ext-oracle以下的包不在下面的合集中yay -S mesen2-git desmume-git yuzu-mainline-bin   #另可选FC和NDS模拟器 不推荐yay -S retroarch retroarch-assets-ozone retroarch-assets-xmb libretro-nestopia-git libretro-vba-next-git libretro-desmume-git    #retroarch 包含很多常见游戏平台的模拟器yay -S genymotion                                 #安卓环境基于vbox,建议添加arm_translation以支持arm转换yay -S v2raya-bin v2ray                           #v2raya</code></pre><details><summary>复制所有</summary><pre><code class="Bash">yay -S clash-premium-bin aria2 chromium gtk4 firefox icalingua++ telegram-desktop-bin youtube-music-bin mpv nomacs kate obs-studio wlrobs-hg refind scrcpy android-tools gamemode steam dxvk-bin vkd3d vkd3d-proton-bin vbam-wx fceux melonds-bin citra-qt-bin ffmpeg4.4 yuzu-mainline-bin virtualbox virtualbox-host-dkms virtualbox-guest-iso virtualbox-ext-oracle</code></pre></details><blockquote><p>arm转译包<br>    <a href="https://github.com/m9rco/Genymotion_ARM_Translation">arm_translation</a></p></blockquote><hr><h2 id="显卡驱动"><a href="#显卡驱动" class="headerlink" title="显卡驱动"></a>显卡驱动</h2><h3 id="英特尔核芯显卡"><a href="#英特尔核芯显卡" class="headerlink" title="英特尔核芯显卡"></a>英特尔核芯显卡</h3><pre><code class="Bash">sudo pacman -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel</code></pre><h3 id="Nvidia显卡驱动"><a href="#Nvidia显卡驱动" class="headerlink" title="Nvidia显卡驱动"></a>Nvidia显卡驱动</h3><pre><code class="Bash">sudo pacman -S nvidia-settings nvidia-utils lib32-nvidia-utils nvidia-dkms nvidia-prime opencl-nvidia lib32-opencl-nvidia vulkan-headers vulkan-icd-loader lib32-vulkan-icd-loader cuda</code></pre><h3 id="视频加速"><a href="#视频加速" class="headerlink" title="视频加速"></a>视频加速</h3><pre><code class="Bash">yay -S libva libva-intel-driver libva-mesa-driver libva-nvidia-driver libva-utils</code></pre><details><summary>复制所有</summary><pre><code class="Bash">yay -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel nvidia-settings nvidia-utils lib32-nvidia-utils nvidia-dkms nvidia-prime opencl-nvidia lib32-opencl-nvidia vulkan-headers vulkan-icd-loader lib32-vulkan-icd-loader cuda libva libva-intel-driver libva-mesa-driver libva-nvidia-driver libva-utils</code></pre></details><pre><code class="Bash">yay -S libva-vdpau-driver-wayland  #与libva-nvidia-driver冲突</code></pre><h3 id="设置早期KMS启动并启用DRM"><a href="#设置早期KMS启动并启用DRM" class="headerlink" title="设置早期KMS启动并启用DRM"></a>设置早期KMS启动并启用DRM</h3><h4 id="添加内核参数"><a href="#添加内核参数" class="headerlink" title="添加内核参数"></a>添加内核参数</h4><blockquote><p>修改 <code>/etc/default/grub</code> 找到 GRUB_CMDLINE_LINUX_DEFAULT这一项在后面加入 nvidia-drm.modeset=1</p></blockquote><pre><code class="Bash">GRUB_CMDLINE_LINUX_DEFAULT="nvidia-drm.modeset=1”</code></pre><blockquote><p>更改完成后执行，下面命令，会重新生成grub.cfg。</p></blockquote><pre><code class="Bash">sudo grub-mkconfig -o /boot/grub/grub.cfg</code></pre><h4 id="添加-initramfs-模块"><a href="#添加-initramfs-模块" class="headerlink" title="添加 initramfs 模块"></a>添加 initramfs 模块</h4><blockquote><p>在 <code>/etc/mkinitcpio.conf</code> 中找到 MODULES=这一行在括号的后面加入intel_agp i915 nvidia nvidia_modeset nvidia_uvm  nvidia_drm。</p></blockquote><pre><code class="Bash">MODULES=(intel_agp i915 nvidia nvidia_modeset nvidia_uvm nvidia_drm)</code></pre><blockquote><p>别忘了重新生成一下 initramfs 执行</p></blockquote><pre><code class="Bash">sudo mkinitcpio -P</code></pre><h3 id="创建nvidia-hook"><a href="#创建nvidia-hook" class="headerlink" title="创建nvidia hook"></a>创建nvidia hook</h3><blockquote><p>创建<code>/etc/pacman.d/hooks/nvidia.hook</code> 内容为</p></blockquote><pre><code class="Bash">[Trigger]Operation=InstallOperation=UpgradeOperation=RemoveType=PackageTarget=nvidia-dkmsTarget=linux-zen# Change the linux part above and in the Exec line if a different kernel is used[Action]Description=Update Nvidia module in initcpioDepends=mkinitcpioWhen=PostTransactionNeedsTargetsExec=/bin/sh -c 'while read -r trg; do case $trg in linux) exit 0; esac; done; /usr/bin/mkinitcpio -P'</code></pre><h3 id="添加全局变量调用nvidia-如果你要用awesome-就不要加入"><a href="#添加全局变量调用nvidia-如果你要用awesome-就不要加入" class="headerlink" title="添加全局变量调用nvidia (如果你要用awesome, 就不要加入)"></a>添加全局变量调用nvidia (如果你要用awesome, 就不要加入)</h3><blockquote><p>sudo vim /etc/environment</p></blockquote><pre><code class="Bash">__NV_PRIME_RENDER_OFFLOAD=1__GLX_VENDOR_LIBRARY_NAME="nvidia"__VK_LAYER_NV_optimus="NVIDIA_only"</code></pre><h2 id="各软件的配置"><a href="#各软件的配置" class="headerlink" title="各软件的配置"></a>各软件的配置</h2><h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><blockquote><p>编辑environment<br>    在 <code>/etc/environment</code> 加入以下内容</p></blockquote><pre><code class="Bash">GTK_IM_MODULE=fcitxQT_IM_MODULE=fcitxXMODIFIERS=@im=fcitxSDL_IM_MODULE=fcitxINPUT_METHOD=fcitxGLFW_IM_MODULE=ibus</code></pre><h3 id="greetd配置"><a href="#greetd配置" class="headerlink" title="greetd配置"></a>greetd配置</h3><blockquote><p>编缉 <code>/etc/greetd/config.toml</code></p></blockquote><pre><code class="Bash">[default_session]command = "tuigreet --cmd wayfire"user = "$USER"</code></pre><h3 id="kitty配置"><a href="#kitty配置" class="headerlink" title="kitty配置"></a>kitty配置</h3><pre><code class="Bash">cd ~/.config/kittyln -s ./kitty-themes/themes/Material.conf ~/.config/kitty/theme.conf</code></pre><blockquote><p>在 <code>kitty.conf</code> 里添加内容</p></blockquote><pre><code class="Bash">include ./theme.conf</code></pre><h3 id="ranger配置"><a href="#ranger配置" class="headerlink" title="ranger配置"></a>ranger配置</h3><pre><code class="Bash">git clone https://github.com/alexanderjeurissen/ranger_devicons ~/.config/ranger/plugins/ranger_deviconsecho "default_linemode devicons" &gt;&gt; $HOME/.config/ranger/rc.conf</code></pre><h3 id="wpaperd配置"><a href="#wpaperd配置" class="headerlink" title="wpaperd配置"></a>wpaperd配置</h3><blockquote><p>定时自动切换壁纸<br>    wpaperd可以针对不同屏幕设置不同的壁纸以及不同定时的自动切换壁纸<br>    以下为2块屏幕的相同定时时读取同一路径下随机壁纸的例子</p></blockquote><pre><code class="Bash">[eDP-1]path = "～/wallpaper/"apply-shadow = trueduration = "6m"[HDMI-A-1]path = "～/wallpaper/"apply-shadow = trueduration = "6m"</code></pre><h3 id="zsh主题-powerlevel10k"><a href="#zsh主题-powerlevel10k" class="headerlink" title="zsh主题-powerlevel10k"></a>zsh主题-powerlevel10k</h3><pre><code class="Bash">echo 'source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme' &gt;&gt; ~/.zshrc</code></pre><h3 id="vbox配置"><a href="#vbox配置" class="headerlink" title="vbox配置"></a>vbox配置</h3><pre><code class="Bash">sudo usermod -a -G vboxusers $USER</code></pre><h3 id="refind配置"><a href="#refind配置" class="headerlink" title="refind配置"></a>refind配置</h3><pre><code class="Bash">refind-install                      #安装refindsudo cp -r $theme /efi/EFI/refind/  #复制主题 推荐rEFInd-minimalsudo suecho 'include themes/rEFInd-minimal/theme.conf' &gt;&gt; /efi/EFI/refind/refind.conf  #应用主题</code></pre><h3 id="aria2配置"><a href="#aria2配置" class="headerlink" title="aria2配置"></a>aria2配置</h3><blockquote><p>编辑 aria2.service<br>sudo vim /etc/systemd/user/aria2.service</p></blockquote><pre><code class="Bash">[Unit]Description=Aria2 Daemon[Service]ExecStart=/usr/bin/aria2c --conf-path=~/.config/aria2/aria2.config[Install]WantedBy=default.target</code></pre><blockquote><p>生成服务所需文件</p></blockquote><pre><code class="Bash">touch ~/.config/aria2/aria2.sessionvim ~/.config/aria2/aria2.config</code></pre><blockquote><p>启动服务</p></blockquote><pre><code class="Bash">systemctl --user enable --now aria2  #非root服务自启</code></pre><blockquote><p>config可以在网上找一份，也可以改一改我的</p></blockquote><h3 id="V2raya"><a href="#V2raya" class="headerlink" title="V2raya"></a>V2raya</h3><pre><code class="Bash">yay -S v2raya-bin v2raysudo systemctl enable --now v2raya  #服务自启Dashboard: 127.0.0.1:2017</code></pre><h3 id="Clash"><a href="#Clash" class="headerlink" title="Clash"></a>Clash</h3><pre><code class="Bash">yay -S clash-meta-bin</code></pre><blockquote><p>start with <code>clash</code><br>如果country.mmdb下载失败, 手动复制<br>再配置自己的配置文件</p></blockquote><pre><code class="Bash">cp $Country.mmdb /home/$username/.config/clash/cp $ur_config.yaml /home/$username/.config/clash/</code></pre><blockquote><p>clash依赖<br>    <a href="https://github.com/SukkaW/Koolshare-Clash/blob/master/koolclash/koolclash/config/Country.mmdb">Country.mmdb</a></p></blockquote><h4 id="Clash-TUN-及分流配置"><a href="#Clash-TUN-及分流配置" class="headerlink" title="Clash TUN 及分流配置"></a>Clash TUN 及分流配置</h4><blockquote><p>开启流量转发</p></blockquote><pre><code class="Bash">sysctl -w net.ipv4.ip_forward=1</code></pre><blockquote><p>53端口可能被占用，先关掉默认系统DNS端口</p></blockquote><pre><code class="Bash">systemctl disable systemd-resolved</code></pre><blockquote><p>配置config.yaml<br>    <a href="https://github.com/MoichiLin/dotfiles/blob/main/clash/config.yaml">dotfile</a></p></blockquote><blockquote><p>编辑 clash.service<br>sudo vim /etc/systemd/system/clash.service</p></blockquote><pre><code class="Bash">[Unit]Description=Clash daemon, A rule-based proxy in Go.After=network.target[Service]Type=simpleRestart=alwaysExecStart=/usr/bin/clash -d ~/.config/clash[Install]WantedBy=default.target</code></pre><blockquote><p>启动服务</p></blockquote><pre><code class="Bash">systemctl enable --now clash #服务自启</code></pre><blockquote><p>Dashboard: <a href="https://clash.razord.top/">https://clash.razord.top/</a></p></blockquote><h3 id="yuzu配置"><a href="#yuzu配置" class="headerlink" title="yuzu配置"></a>yuzu配置</h3><blockquote><p>放置yuzu key<br>    运行yuzu需要key<br>    把以下文件解压覆盖到</p></blockquote><pre><code class="Bash">~/.local/share/yuzu/`</code></pre><blockquote><p>key文件<br>    <a href="https://www.dropbox.com/s/zzmrx35emikqfn0/YUZU_KEY.rar?dl=0">YUZU_KEY</a></p></blockquote><h3 id="Chromium-开启Google-Chrome同步"><a href="#Chromium-开启Google-Chrome同步" class="headerlink" title="Chromium 开启Google Chrome同步"></a>Chromium 开启Google Chrome同步</h3><blockquote><p>其他文章<br>    <a href="https://www.moichi.cn/posts/2023/02/06/Chromium-Google-Sync/">本站跳转</a></p></blockquote><h3 id="Chrome-wayland-不建议"><a href="#Chrome-wayland-不建议" class="headerlink" title="Chrome wayland (不建议)"></a>Chrome wayland (不建议)</h3><blockquote><p>让Chrome在wayland下运行<br>    把 <code>--gtk-version=4</code> 添加到每一个Exec的未尾<br>    在chrome上打开chrome://flags<br>    Preferred Ozone platform 换成 wayland<br>    以支持fcitx5在chrome在wayland下运行</p></blockquote><pre><code class="Bash">sudo vim /usr/share/applications/google-chrome.desktop</code></pre><hr><h2 id="Waydroid-不推荐"><a href="#Waydroid-不推荐" class="headerlink" title="Waydroid (不推荐)"></a>Waydroid (不推荐)</h2><pre><code class="Bash">yay -S waydroid waydroid-imagesudo waydroid initsudo waydroid init -s GAPPS -fsystemctl start waydroid-container.servicewaydroid session startwaydroid show-full-uisudo mount --bind &lt;source&gt; ~/.local/share/waydroid/data/media/0/&lt;target&gt; #共享文件夹</code></pre><hr><h1 id="Awesome"><a href="#Awesome" class="headerlink" title="Awesome"></a>Awesome</h1><pre><code class="Bash">sudo pacman -S xorg-server xorg-xinit xtermparu -S awesome-git picom-git playerctl pamixer numlockxparu -S feh flameshot rofiparu -S ttf-roboto-mono-nerd ttf-robotoecho "exec awesome" &gt; ~/.xinitrc</code></pre><blockquote><p>启动awesome<br>    启动时，需要在greetd里F2更改命令为<code>startx</code></p></blockquote><blockquote><p>定时自动切换壁纸<br>    先写一个sh让它开机时自动运行<br>    sh里就写上feh设置随机壁纸的循环<br>    <code>vim ~/wallpaper/readom.sh</code><br>    6m自动切换一次</p></blockquote><pre><code class="Bash">while true; dofeh --bg-fill --randomize --no-fehbg ~/wallpaper/*sleep 6mdone</code></pre>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
            <tag> wayfire </tag>
            
            <tag> awesome </tag>
            
            <tag> wayland </tag>
            
            <tag> X11 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Arch Linux Installation</title>
      <link href="/posts/2023/01/24/Arch-Linux-Install/"/>
      <url>/posts/2023/01/24/Arch-Linux-Install/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://pic.imgdb.cn/item/63d57e12face21e9ef3b7f19.png" alt="ArchHandBook" title="ArchLinux" loading="lazy"></p><blockquote><p>本篇皆在搭建好Arch的所有基础环境，不涉及DE和WM的安装</p></blockquote><span id="more"></span><hr><blockquote><p>本文来源 <a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/">ArchLinuxStudio</a></p></blockquote><h1 id="Arch-Linux-基础安装"><a href="#Arch-Linux-基础安装" class="headerlink" title="Arch Linux 基础安装"></a>Arch Linux 基础安装</h1><p>本节从安装最基础的无图形化 ArchLinux 系统开始。<a href="https://wiki.archlinux.org/index.php/Installation_guide">官方安装指南</a></p><h2 id="禁用-reflector"><a href="#禁用-reflector" class="headerlink" title="禁用 reflector"></a>禁用 reflector</h2><p>reflector 会为你选择速度合适的镜像源，但其结果并不准确，同时会清空配置文件中的内容，对于新人来讲并不适用，我们首先对其进行禁用。</p><pre><code class="Bash">systemctl stop reflector.service</code></pre><h2 id="再次确保是否为-UEFI-模式"><a href="#再次确保是否为-UEFI-模式" class="headerlink" title="再次确保是否为 UEFI 模式"></a>再次确保是否为 UEFI 模式</h2><pre><code class="Bash">ls /sys/firmware/efi/efivars</code></pre><h2 id="连接网络"><a href="#连接网络" class="headerlink" title="连接网络"></a>连接网络</h2><pre><code class="Bash">rfkill unblock wifi                       #解锁无线网卡iwctl                                     #执行iwctl命令，进入交互式命令行device list                               #列出设备名，比如无线网卡看到叫 wlan0station wlan0 scan                        #扫描网络station wlan0 get-networks                #列出网络 比如想连接YOUR-WIRELESS-NAME这个无线station wlan0 connect YOUR-WIRELESS-NAME  #进行连接 输入密码即可exit                                      #成功后exit退出</code></pre><h2 id="更新系统时钟"><a href="#更新系统时钟" class="headerlink" title="更新系统时钟"></a>更新系统时钟</h2><pre><code class="Bash">timedatectl set-ntp true        #将系统时间与网络时间进行同步timedatectl status              #检查服务状态</code></pre><h2 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h2><p>首先将磁盘转换为 gpt 类型</p><pre><code class="Bash">lsblk                           #显示分区情况 找到你想安装的磁盘名称parted /dev/nvme0n1             #执行parted，进入交互式命令行，进行磁盘类型变更(parted)mktable                 #输入mktableNew disk label type? gpt        #输入gpt 将磁盘类型转换为gpt 如磁盘有数据会警告，输入yes即可quit                            #最后quit退出parted命令行交互</code></pre><p>使用 cfdisk 命令对磁盘分区</p><pre><code class="Bash">cfdisk /dev/sdx                 #来执行分区操作,分配各个分区大小，类型fdisk -l                        #分区结束后， 复查磁盘情况</code></pre><h2 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h2><pre><code class="Bash">mkfs.ext4  /dev/nvme0n1p2       #格式化根目录和home目录的两个分区mkfs.vfat  /dev/nvme0n1p1       #格式化efi分区</code></pre><h2 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h2><p>在挂载时，挂载是有顺序的，先挂载根分区，再挂载 EFI 分区</p><pre><code class="Bash">mount /dev/nvme0n1p2  /mntmkdir /mnt/efi                  #创建efi目录mkdir /mnt/home                 #创建home目录mount /dev/nvme0n1p1 /mnt/efimount /dev/sda1 /mnt/home</code></pre><h2 id="镜像源的选择"><a href="#镜像源的选择" class="headerlink" title="镜像源的选择"></a>镜像源的选择</h2><p>编辑镜像源，选择ustc等源提前</p><pre><code class="Bash">vim /etc/pacman.d/mirrorlist</code></pre><h2 id="安装系统"><a href="#安装系统" class="headerlink" title="安装系统"></a>安装系统</h2><pre><code class="Bash">pacstrap /mnt base base-devel linux-zen linux-zen-headers linux-firmware    #base-devel在AUR包的安装是必须的pacstrap /mnt dhcpcd iwd vim bash-completion fish networkmanager             #一个有线所需(iwd也需要dhcpcd) 一个无线所需 一个编辑器 一个补全工具</code></pre><h2 id="生成-fstab-文件"><a href="#生成-fstab-文件" class="headerlink" title="生成 fstab 文件"></a>生成 fstab 文件</h2><p>fstab 用来定义磁盘分区</p><pre><code class="Bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></pre><h2 id="change-root"><a href="#change-root" class="headerlink" title="change root"></a>change root</h2><pre><code class="Bash">arch-chroot /mnt</code></pre><h2 id="时区设置"><a href="#时区设置" class="headerlink" title="时区设置"></a>时区设置</h2><p>设置时区，在 /etc/localtime 下用/usr 中合适的时区创建符号连接。如下设置上海时区。</p><pre><code class="Bash">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></pre><p>随后进行硬件时间设置，将当前的正确 UTC 时间写入硬件时间。</p><pre><code class="Bash">hwclock --systohc</code></pre><h2 id="设置-Locale-进行本地化"><a href="#设置-Locale-进行本地化" class="headerlink" title="设置 Locale 进行本地化"></a>设置 Locale 进行本地化</h2><pre><code class="Bash">vim /etc/locale.gen             #en_US.UTF-8 所在行以及 zh_CN.UTF-8 所在行的注释符号（#）locale-gen</code></pre><p>向 <code>/etc/locale.conf</code> 导入内容</p><pre><code class="Bash">echo 'LANG=en_US.UTF-8' &gt; /etc/locale.conf</code></pre><h2 id="设置主机名"><a href="#设置主机名" class="headerlink" title="设置主机名"></a>设置主机名</h2><pre><code class="Bash">vim /etc/hostname               #加入你想为主机取的主机名</code></pre><p>接下来在/etc/hosts设置与其匹配的条目。</p><pre><code class="Bash">vim /etc/hosts</code></pre><p>加入如下内容</p><pre><code class="Bash">127.0.0.1   localhost::1         localhost127.0.1.1   archname</code></pre><p>vim 编辑<code>/etc/resolv.conf</code>，删除已有条目，并将如下内容加入其中</p><pre><code class="Bash">nameserver 8.8.8.8nameserver 2001:4860:4860::8888nameserver 8.8.4.4nameserver 2001:4860:4860::8844</code></pre><p>固化文件</p><pre><code class="Bash">chattr +i /etc/resolv.conf</code></pre><h2 id="为-root-用户设置密码"><a href="#为-root-用户设置密码" class="headerlink" title="为 root 用户设置密码"></a>为 root 用户设置密码</h2><pre><code class="Bash">passwd root</code></pre><h2 id="安装微码"><a href="#安装微码" class="headerlink" title="安装微码"></a>安装微码</h2><pre><code class="Bash">pacman -S intel-ucode           #Intelpacman -S amd-ucode             #AMD</code></pre><h2 id="安装引导程序"><a href="#安装引导程序" class="headerlink" title="安装引导程序"></a>安装引导程序</h2><pre><code class="Bash">pacman -S grub efibootmgr       #grub是启动引导器，efibootmgr被 grub 脚本用来将启动项写入 NVRAM。grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=GRUB</code></pre><p>接下来编辑/etc/default/grub 文件，去掉GRUB_CMDLINE_LINUX_DEFAULT一行中最后的 quiet 参数，同时把 log level 的数值从 3 改成 5。这样是为了后续如果出现系统错误，方便排错。同时在同一行加入 nowatchdog 参数，这可以显著提高开关机速度。</p><pre><code class="Bash">vim /etc/default/grub</code></pre><p>最后生成 GRUB 所需的配置文件</p><pre><code class="Bash">grub-mkconfig -o /boot/grub/grub.cfg</code></pre><h2 id="完成安装"><a href="#完成安装" class="headerlink" title="完成安装"></a>完成安装</h2><pre><code class="Bash">exit                           #退回安装环境umount -R  /mnt                #卸载新分区reboot                         #重启</code></pre><p>重启后，开启 dhcp 服务，即可连接网络</p><pre><code class="Bash">systemctl enable --now dhcpcd  #立即启动dhcp</code></pre><p>若为无线链接，则还需要启动 iwd 才可以使用 iwctl 连接网络</p><pre><code class="Bash">systemctl start iwd            #立即启动iwdiwctl                          #和之前的方式一样，连接无线网络</code></pre><h2 id="准备非-root-用户"><a href="#准备非-root-用户" class="headerlink" title="准备非 root 用户"></a>准备非 root 用户</h2><pre><code class="Bash">useradd -m -G wheel -s /bin/fish testuser  #wheel附加组可sudo，以root用户执行命令 -m同时创建用户家目录</code></pre><p>设置新用户 testuser 的密码</p><pre><code class="Bash">passwd testuser</code></pre><p>编辑 sudoers 配置文件</p><pre><code class="Bash">EDITOR=vim visudo              #需要以 root 用户运行 visudo 命令</code></pre><p>找到下面这样的一行，把前面的注释符号 # 去掉，:wq 保存并退出即可。</p><pre><code class="Bash">#%wheel ALL=(ALL) ALL</code></pre>]]></content>
      
      
      <categories>
          
          <category> tutorial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> arch </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
